import{r as t,c as e,h as i,H as a,a as n,w as s}from"./p-aff91b47.js";import{s as o}from"./p-fd194414.js";import"./p-a03d57a1.js";import{s as r}from"./p-a6712bf4.js";import{d,b as c}from"./p-c709b180.js";import{a as l,c as h}from"./p-e497ad6d.js";import{S as p}from"./p-86cdc955.js";import{d as b}from"./p-a08b5a59.js";import{M as g,j as y}from"./p-83da1e09.js";import{d as v,f as u,e as f}from"./p-382270d8.js";import{s as m}from"./p-0752f2ba.js";import{d as x}from"./p-5a97005d.js";import{R as w}from"./p-fd4b6d8b.js";import{D as k}from"./p-5b5e70d9.js";import{f as j}from"./p-338c7261.js";import"./p-ae02fe11.js";import"./p-bf38ee7f.js";import"./p-2c3cda13.js";import"./p-5605a420.js";var _=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};const C=class{constructor(i){t(this,i),this.search=e(this,"search",7),this.searchDismissed=e(this,"searchDismissed",7),this.back=e(this,"back",7),this.iconPack=d,this.t=c(),this.showChannelDetailsDialog=!1,this.showSearchBar=!1,this.members=[],this.showBackButton=!1}onChannelChanged(){this.$searchInput&&(this.$searchInput.value=""),this.showSearchBar=!1,this.channel.isDirectMessage||this.meeting.chat.getChannelMembers(this.channel.id).then((t=>{this.members=t}))}connectedCallback(){this.onChannelChanged()}renderChannelDetails(){return i("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.showChannelDetailsDialog=!1},iconPack:this.iconPack,t:this.t},i("dyte-channel-details",{members:this.members,channel:this.channel}))}render(){return this.channel?i(a,null,this.showChannelDetailsDialog&&this.renderChannelDetails(),i("header",{class:{searching:this.showSearchBar}},this.showBackButton&&i("dyte-button",{kind:"icon",variant:"secondary",class:"back-btn",onClick:()=>{this.back.emit()}},i("dyte-icon",{icon:this.iconPack.chevron_left})),i("div",{class:"channel-details"},i("span",{class:"name"},this.channel.displayName),!this.channel.isDirectMessage&&i("span",{class:"members"},this.members.map((t=>t.name)).join(", "))),i("div",{class:"channel-tools"},!this.channel.isDirectMessage&&i("dyte-tooltip",{label:this.t("chat.channel_members"),variant:"primary"},i("dyte-button",{kind:"button",variant:"secondary",size:"md",onClick:()=>{this.showChannelDetailsDialog=!this.showChannelDetailsDialog},class:"br-primary-btn"},i("dyte-icon",{icon:this.iconPack.people})))))):null}static get watchers(){return{channel:["onChannelChanged"]}}};_([p()],C.prototype,"meeting",void 0),_([p()],C.prototype,"iconPack",void 0),_([p()],C.prototype,"t",void 0),C.style="header{box-sizing:border-box;height:var(--dyte-space-16, 64px);width:100%;padding:var(--dyte-space-4, 16px);display:flex;justify-content:space-between;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}header.searching{justify-content:flex-end}header.searching .channel-details{display:none}header .channel-details{display:flex;flex-grow:1;flex-direction:column;justify-content:center;height:var(--dyte-space-9, 36px);width:var(--dyte-space-1, 4px)}header .channel-details .name{font-weight:500}header .channel-details .members{margin-top:var(--dyte-space-0\\.5, 2px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}header .channel-tools{display:flex;flex-shrink:0;justify-content:flex-end;gap:var(--dyte-space-1, 4px);min-width:var(--dyte-space-24, 96px)}header .channel-tools dyte-tooltip{height:var(--dyte-space-8, 32px);width:var(--dyte-space-10, 40px);display:flex}header .search-input{height:var(--dyte-space-8, 32px);width:var(--dyte-space-48, 192px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header .name{font-size:16px}header .br-primary-btn{background-color:transparent}header .br-primary-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}@media (orientation: landscape) and (min-width: 400px){header.searching .channel-details{display:flex}}.back-btn{margin-right:var(--dyte-space-3, 12px)}";var D=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};const R=class{constructor(i){t(this,i),this.channelChange=e(this,"channelChange",7),this.disableSearch=!1,this.hideAvatar=!1,this.iconPack=d,this.t=c(),this.viewAs="list",this.searchQuery="",this.showDropdown=!1,this.calculateListHeight=b((()=>{if("list"===this.viewAs&&this.$listEl){let t=0;const e=this.$el.shadowRoot.querySelector('slot[name="header"]');e&&e.assignedElements().forEach((e=>t+=e.offsetHeight)),this.$searchEl&&(t+=this.$searchEl.offsetHeight),this.$listEl.style.height=window.innerHeight-t-16+"px"}}),60),this.getFilteredChannels=()=>""===this.searchQuery.trim()?this.channels:this.channels.filter((t=>t.name.toLowerCase().includes(this.searchQuery.toLowerCase()))),this.toggleDropdown=()=>{this.showDropdown=!this.showDropdown},this.getChannelById=t=>this.channels.find((e=>e.id===t)),this.getTotalUnreads=()=>this.channels.reduce(((t,e)=>t+e.unreadCount),0),this.onChannelClickHandler=t=>{this.channelChange.emit(t),"dropdown"===this.viewAs&&(this.showDropdown=!1)}}connectedCallback(){this.resizeObserver=new ResizeObserver(this.calculateListHeight)}componentDidLoad(){this.resizeObserver.observe(this.$el),this.calculateListHeight()}disconnectedCallback(){var t;null===(t=this.resizeObserver)||void 0===t||t.disconnect(),this.calculateListHeight.cancel()}getTimeLabel(t){const e=new Date,i=new Date(e);i.setDate(e.getDate()-1);const a=new Date(e);return a.setDate(e.getDate()-e.getDay()-1),t.toDateString()===e.toDateString()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toDateString()===i.toDateString()?this.t("date.yesteday"):t>a?this.t(["date.sunday","date.monday","date.tuesday","date.wednesday","date.thursday","date.friday","date.saturday"][t.getDay()]):Intl.DateTimeFormat([],{day:"2-digit",month:"2-digit",year:"2-digit"}).format(t)}render(){const t=this.getFilteredChannels(),e="list"===this.viewAs||"dropdown"===this.viewAs&&this.showDropdown;return i(a,{key:"ade72de18b78275705bb0b39f9923977b8ef479e"},"list"===this.viewAs&&i("slot",{key:"879f77f7f57896e2ef37ba1abfede94bbdd66b8c",name:"header"}),e&&i("div",{key:"a0d9818c26533cf1a65ec70cb385d6ac33ad6c6f",class:{dropdown:"dropdown"===this.viewAs,scrollbar:"dropdown"===this.viewAs,list:"list"===this.viewAs}},!this.disableSearch&&i("div",{key:"428ca579360c29a390084c8f1969091c6b904a5a",class:"search-container",ref:t=>this.$searchEl=t},i("input",{key:"255cbcd3cda43fd2fd8bd3a65cda1f6271476fb9",type:"text",placeholder:this.t("chat.search_conversations"),value:this.searchQuery,onInput:t=>this.searchQuery=t.target.value}),i("dyte-icon",{key:"e85c4413dcd97df62fc96cf23aab4c0ef7276d79",icon:this.iconPack.search})),i("div",{key:"a09eb0f58d6341be68cfc52832e84048f11946be",class:"channels-container scrollbar",ref:t=>this.$listEl=t},t.map((t=>i("button",{class:{channel:!0,active:this.selectedChannelId===t.id},onClick:()=>this.onChannelClickHandler(t)},!this.hideAvatar&&i("div",null,t.icon?i("dyte-icon",{class:"avatar-icon",icon:this.iconPack[t.icon]}):i("dyte-avatar",{participant:{name:t.name,picture:t.avatarUrl}})),i("div",{class:"channel-data"},i("div",{class:"col"},i("div",{class:"name"},t.name),t.latestMessage&&i("div",{class:{"last-message":!0,"no-message":!t.latestMessage}},i("dyte-text-message-view",{isMarkdown:!0,text:t.latestMessage}))),i("div",{class:"col channel-meta"},t.latestMessageTime&&i("time",{class:"time"},this.getTimeLabel(t.latestMessageTime)),t.unreadCount>0&&i("div",{class:"unread-count"},t.unreadCount)))))))),"dropdown"===this.viewAs&&i("button",{key:"af78d56510b62beeee9e17162a0fbe5a75b0b1af",class:"dropdown-trigger",onClick:this.toggleDropdown},i("span",{key:"10c170707e3c084d4a0a1a322128f6e685c075ed"},this.selectedChannelId&&`${this.t("to")} ${this.getChannelById(this.selectedChannelId).name}`,this.getTotalUnreads()>0&&i("div",{key:"b45263bedbb36f6b25cb595067a2418a110e9e45",class:"unread-count"},this.getTotalUnreads())),i("dyte-icon",{key:"ca61473ab2f859378fea75468dbf194a137ceba0",icon:this.showDropdown?this.iconPack.chevron_up:this.iconPack.chevron_down})))}get $el(){return n(this)}};D([p()],R.prototype,"iconPack",void 0),D([p()],R.prototype,"t",void 0),R.style=".scrollbar {\n  /* For Firefox */\n  scrollbar-width: thin;\n  scrollbar-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent);\n}\n\n/* For WebKit */\n.scrollbar::-webkit-scrollbar {\n  height: var(--dyte-space-1\\.5, 6px);\n  width: var(--dyte-space-1\\.5, 6px);\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-background, transparent);\n}\n\n.scrollbar::-webkit-scrollbar-thumb {\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)));\n}\n\n\n:host {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  position: relative;\n  z-index: 10;\n  height: var(--dyte-space-12, 48px);\n  min-height: 48px;\n}\n\n.dropdown-trigger {\n  height: 100%;\n  width: 100%;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  padding: var(--dyte-space-4, 16px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));\n  font-size: 14px;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  cursor: pointer;\n  position: absolute;\n  z-index: 20;\n}\n\n.dropdown-trigger span {\n  display: flex;\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.dropdown-trigger dyte-icon {\n  margin-left: var(--dyte-space-1, 4px);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  flex-shrink: 0;\n}\n\n@container chatcontainer (height < 360px) {\n  .dropdown-trigger {\n    padding: var(--dyte-space-2, 8px);\n  }\n  .dropdown {\n    top: var(--dyte-space-8, 32px) !important;\n  }\n  .search-container {\n    padding-left: var(--dyte-space-0, 0px) !important;\n    padding-right: var(--dyte-space-0, 0px) !important;\n    padding-top: var(--dyte-space-0, 0px) !important;\n    padding-bottom: var(--dyte-space-0, 0px) !important;\n  }\n  input {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-none, 0) !important;\n  }\n  .channel {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-sm, 4px) !important;\n  }\n  .avatar-icon {\n    height: var(--dyte-space-3, 12px) !important;\n    width: var(--dyte-space-3, 12px) !important;\n    padding: var(--dyte-space-1, 4px) !important;\n  }\n\n  dyte-avatar {\n    height: var(--dyte-space-5, 20px) !important;\n    width: var(--dyte-space-5, 20px) !important;\n  }\n}\n\n.dropdown {\n  position: absolute;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  top: var(--dyte-space-12, 48px);\n  z-index: 10;\n  animation: 0.3s slide-down ease;\n}\n\n.dropdown .channels-container {\n  max-height: var(--dyte-space-80, 320px);\n}\n\n.list {\n  display: flex;\n  flex-direction: column;\n}\n\n.list .channel .channel-data {\n  align-items: flex-start;\n}\n\n.unread-count {\n  display: flex;\n  justify-content: center;\n  height: var(--dyte-space-5, 20px);\n  min-width: var(--dyte-space-3, 12px);\n  border-radius: 9999px;\n  padding-left: var(--dyte-space-1, 4px);\n  padding-right: var(--dyte-space-1, 4px);\n  font-size: 12px;\n  line-height: 1.25rem;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\ninput {\n  height: var(--dyte-space-9, 36px);\n  width: 100%;\n  padding-left: var(--dyte-space-3, 12px);\n  padding-right: var(--dyte-space-3, 12px);\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  border-radius: var(--dyte-border-radius-sm, 4px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.search-container {\n  display: flex;\n  flex-shrink: 0;\n  flex-grow: 0;\n  flex-basis: auto;\n  align-items: center;\n  padding-top: var(--dyte-space-3, 12px);\n  padding-bottom: var(--dyte-space-3, 12px);\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-2, 8px);\n  border-bottom: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-700, 44 44 44));\n}\n\n.search-container dyte-icon {\n  margin-left: calc(var(--dyte-space-8, 32px) * -1);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channels-container {\n  display: flex;\n  flex-direction: column;\n  gap: var(--dyte-space-1, 4px);\n  padding: var(--dyte-space-2, 8px);\n  flex: 1 1 auto;\n  overflow-y: auto;\n}\n\n.channel {\n  flex-shrink: 0;\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  background-color: transparent;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  cursor: pointer;\n  border-radius: var(--dyte-border-radius-md, 8px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: var(--dyte-space-2, 8px);\n  height: var(--dyte-space-16, 64px);\n  width: 100%;\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.channel:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n}\n\n.channel .channel-data {\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.channel .name {\n  font-size: 16px;\n}\n\n.channel .name, \n  .channel .last-message {\n  max-width: var(--dyte-space-40, 160px);\n  text-align: left;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n}\n\n.channel .no-message {\n  font-style: italic;\n}\n\n.channel dyte-avatar {\n  height: var(--dyte-space-12, 48px);\n  width: var(--dyte-space-12, 48px);\n  overflow: clip;\n  border-radius: 9999px;\n  font-size: 14px;\n}\n\n.channel .avatar-icon {\n  height: var(--dyte-space-6, 24px);\n  width: var(--dyte-space-6, 24px);\n  padding: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n  overflow: clip;\n  border-radius: 9999px;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n}\n\n.channel time, \n  .channel .last-message {\n  font-size: 12px;\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channel.active {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.channel.active .unread-count {\n  background-color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity));\n}\n\n.channel.active time {\n  color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n}\n\n.channel.active .last-message {\n  color: rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)));\n}\n\n.channel.active dyte-avatar {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.col {\n  gap: var(--dyte-space-1, 4px);\n  display: flex;\n  flex-direction: column;\n}\n\n.channel-meta {\n  flex-shrink: 0;\n  align-items: flex-end;\n}\n\n@keyframes slide-down {\n  from {\n    transform: translateY(-50px);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";var O=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};const $={messagesSent:0,startTime:0},z=class{constructor(i){t(this,i),this.onNewMessage=e(this,"newMessage",7),this.onEditMessage=e(this,"editMessage",7),this.onEditCancel=e(this,"editCancel",7),this.onQuotedMessageDismiss=e(this,"quotedMessageDismiss",7),this.canSendTextMessage=!0,this.canSendFiles=!0,this.message="",this.quotedMessage="",this.storageKey="dyte-text-message",this.inputTextPlaceholder="Enter your message",this.isEditing=!1,this.iconPack=d,this.t=c(),this.disableEmojiPicker=!1,this.rateLimits={period:60,maxInvocations:60},this.fileToUpload=null,this.isEmojiPickerOpen=!1,this.disableSendButton=!1,this.rateLimitsBreached=!1,this.textMessage="",this.sendFile=()=>{this.canSendFiles&&(this.onNewMessage.emit("image"===this.fileToUpload.type?{type:"image",image:this.fileToUpload.file}:{type:"file",file:this.fileToUpload.file}),this.fileToUpload=null)},this.handleSendMessage=()=>{if(!this.canSendTextMessage||this.rateLimitsBreached)return;if(null!==this.fileToUpload)return void this.sendFile();const t=this.textMessage,e=Date.now();e-$.startTime>1e3*this.rateLimits.period&&($.startTime=e,$.messagesSent=0),$.messagesSent+=1,this.checkRateLimitBreached(e),t.length>0&&(this.onNewMessage.emit({type:"text",message:t}),this.cleanup())},this.handleEditMessage=()=>{this.onEditMessage.emit(this.textMessage),this.cleanup()},this.handleEditCancel=()=>{this.onEditCancel.emit(),this.cleanup()},this.onTextChangeHandler=t=>{var e;this.textMessage=t.detail,this.textMessage.length>=(null!==(e=this.maxLength)&&void 0!==e?e:g)?this.disableSendButton=!0:this.disableSendButton&&(this.disableSendButton=!1),l.setItem(this.storageKey,t.detail)},this.onKeyDownHandler=t=>{"Enter"===t.key&&t.shiftKey||this.disableSendButton||"Enter"===t.key&&(t.preventDefault(),this.isEditing?this.handleEditMessage():this.handleSendMessage())},this.onFileUploadHandler=(t,e)=>{this.fileToUpload={type:t,file:e}},this.onQuotedMessageDismissHandler=()=>{this.onQuotedMessageDismiss.emit()},this.cleanup=()=>{this.textMessage="",this.fileToUpload=null,l.setItem(this.storageKey,""),this.$textComposer.setText("",!0),this.isEmojiPickerOpen=!1},this.onKeyDownHandler=this.onKeyDownHandler.bind(this)}connectedCallback(){this.textMessage=this.message||l.getItem(this.storageKey)||"",this.checkRateLimitBreached(Date.now())}componentWillUpdate(){this.textMessage=this.message||l.getItem(this.storageKey)||""}componentDidLoad(){this.message&&s((()=>this.$textComposer.setText(this.message,!0)))}checkRateLimitBreached(t){$.messagesSent>=this.rateLimits.maxInvocations&&(this.disableSendButton=!0,this.rateLimitsBreached=!0,setTimeout((()=>{$.messagesSent=0,$.startTime=Date.now(),this.disableSendButton=!1,this.rateLimitsBreached=!1}),t-$.startTime+1e3*this.rateLimits.period))}render(){var t;const e={iconPack:this.iconPack,t:this.t};return i(a,{key:"95620bf735e02420c033845ae103fab66aeeb75e"},this.canSendTextMessage&&this.isEmojiPickerOpen&&i("dyte-emoji-picker",Object.assign({key:"3868d9d396a835420f2678c37893970b70f3b170",part:"emoji-picker",onPickerClose:()=>{this.isEmojiPickerOpen=!1},onDyteEmojiClicked:t=>{this.textMessage+=t.detail,this.$textComposer.setText(this.textMessage,!0)}},e)),i("slot",{key:"8a2aa4a9fb2f55a7a77520753b9d3115364a4a04",name:"chat-addon"}),this.quotedMessage&&0!==this.quotedMessage.length&&i("div",{key:"7138dd4f349617bb81aa2c6c08d9dd3fd6a9d108",class:"quoted-message-container",part:"quoted-message-container"},i("div",{key:"e31eafb728e357410188880bc7a4817122ee8409",class:"quoted-message scrollbar"},i("dyte-text-message-view",{key:"8879ed9bd53808ed506dd41fdeed00ad4c3ea4ac",text:this.quotedMessage,isMarkdown:!0})),i("div",{key:"de8789772558c152d043dbe3a6fcc90bc43131ae"},i("dyte-icon",{key:"bf2f5458477e5152d7b2c97ad9c77683054b18c4","aria-label":this.t("dismiss"),class:"dismiss",icon:this.iconPack.dismiss,onClick:this.onQuotedMessageDismissHandler}))),i("div",{key:"9ee6084a28c959cfd52e95ad1b0dc621d06af109",class:"composer-container"},i("div",{key:"c215305f9c983d952daba446c117a8760266c545",class:"composers"},this.fileToUpload&&i("dyte-draft-attachment-view",Object.assign({key:"87091bdf699fb3f435ad8fc815394c1938b7e93d"},e,{attachment:this.fileToUpload,onDeleteAttachment:()=>this.fileToUpload=null})),!this.fileToUpload&&i("dyte-text-composer-view",{key:"310a20fa5d90e414f817f6f5138c0528c4df7092",value:this.textMessage,placeholder:this.inputTextPlaceholder,onTextChange:this.onTextChangeHandler,keyDownHandler:this.onKeyDownHandler,maxLength:null!==(t=this.maxLength)&&void 0!==t?t:g,rateLimitBreached:this.rateLimitsBreached,t:this.t,iconPack:this.iconPack,ref:t=>this.$textComposer=t})),i("div",{key:"29e539fa26a6634879efd64e275b85cd7340808d",class:"chat-buttons",part:"chat-buttons"},i("div",{key:"049005d0420c7ac9a761cdcc3787f5295ae340fa",class:"left",part:"chat-buttons-left"},!this.fileToUpload&&!this.isEditing&&i("div",{key:"0af3b2cb7fa8280a206e8a8e565a2eaca9e55a4a"},this.canSendFiles&&[i("dyte-file-picker-button",Object.assign({key:"d0ec56deff6f82e08cd9028b182422f74a551737"},e,{onFileChange:t=>this.onFileUploadHandler("file",t.detail)})),i("dyte-file-picker-button",Object.assign({key:"1186183f76d359b9296632fd7c113c07a05bd681",filter:"image/*",label:this.t("chat.send_img"),icon:"image",onFileChange:t=>this.onFileUploadHandler("image",t.detail)},e))],this.canSendTextMessage&&!this.disableEmojiPicker&&i("dyte-emoji-picker-button",Object.assign({key:"c6f3db68a63f6c9057c968b376827929152dac83",isActive:this.isEmojiPickerOpen,onClick:()=>{this.isEmojiPickerOpen=!this.isEmojiPickerOpen}},e)),i("slot",{key:"515edfbe524ff1d12a1effea567788f6b85b2131",name:"chat-buttons"}))),i("div",{key:"3e1c8a5952e96896695fa3ad1bfc519d5f544e6c",class:"right",part:"chat-buttons-right"},!this.isEditing&&i("dyte-tooltip",{key:"6cc472beb91ffe9c3e3458754bd3ff14155d4e78",variant:"primary",label:this.t("chat.send_msg"),delay:2e3},i("dyte-button",{key:"57328d07846b071cb0e6dc38501c454ea2eb144b",kind:"icon",disabled:this.disableSendButton,onClick:()=>this.handleSendMessage(),title:this.t("chat.send_msg")},i("dyte-icon",{key:"449ea0eb6141bd1c647e27cbe783d5127aa78e5b",icon:this.iconPack.send}))),this.isEditing&&i("div",{key:"e6bf445c6f48c65a5b6eb73e0f5d837952d1b3de",class:"edit-buttons"},i("dyte-tooltip",{key:"c22456ab59399f0dccce72e9417455819ff11587",variant:"secondary",label:this.t("cancel"),delay:2e3},i("dyte-button",{key:"0af483a71ebd06f3cf608843403f887e50454a4f",kind:"icon",variant:"secondary",onClick:()=>this.handleEditCancel(),title:this.t("cancel")},i("dyte-icon",{key:"ee4923945e7fbebe86f6eafdaf235d61e909a37e",icon:this.iconPack.dismiss}))),i("dyte-tooltip",{key:"e60accfc06045cea6ccefff8a170f861297bfc37",variant:"primary",label:this.t("chat.update_msg"),delay:2e3},i("dyte-button",{key:"299711f6040a54d4eb9130b5d6626b10e2b8b73b",kind:"icon",onClick:()=>this.handleEditMessage(),title:this.t("chat.send_msg")},i("dyte-icon",{key:"5ecf6706c6ecdddc0f8e2cf3786697c4adad4b59",icon:this.iconPack.checkmark}))))))))}};O([p()],z.prototype,"iconPack",void 0),O([p()],z.prototype,"t",void 0),z.style=":host {\n  display: flex;\n  flex-direction: column;\n  font-family: var(--dyte-font-family, sans-serif);\n  font-size: 14px;\n  position: relative;\n}\n\n.quoted-message-container {\n  margin-bottom: var(--dyte-space-2, 8px);\n  display: flex;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.quoted-message-container .quoted-message {\n  flex: 1 1 0%;\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  max-height: var(--dyte-space-24, 96px);\n  overflow-y: auto;\n  word-break: break-all;\n}\n\n.quoted-message-container .quoted-message blockquote {\n  display: none;\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  margin-left: auto;\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  color: rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));\n}\n\n.quoted-message-container dyte-icon.dismiss:hover {\n  cursor: pointer;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.composer-container {\n  position: relative;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  overflow: hidden;\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.composer-container > .composers {\n    min-height: 60px;\n  }\n\n@container chatcontainer (height < 360px) {\n    .composer-container > .composers {\n      min-height: 30px;\n    }\n}\n\n.chat-buttons {\n  padding: var(--dyte-space-3, 12px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.chat-buttons .right {\n  z-index: 10;\n}\n\n.chat-buttons .right .edit-buttons {\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.chat-buttons > div {\n  display: flex;\n  align-items: center;\n}\n\ndyte-emoji-picker {\n  z-index: 20;\n  position: absolute;\n  top: calc(var(--dyte-space-72, 288px) * -1);\n  border-top: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n  animation: 0.3s slide-up ease;\n}\n\n@keyframes slide-up {\n  from {\n    transform: translateY(100%);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";var P=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};const q=class{constructor(i){t(this,i),this.onPinMessage=e(this,"pinMessage",7),this.stateUpdate=e(this,"dyteStateUpdate",7),this.observingEl=[],this.autoScrollEnabled=!0,this.messages=[],this.canPinMessages=!1,this.iconPack=d,this.t=c(),this.now=new Date,this.showLatestMessageButton=!1,this.onScroll=t=>{const e=t.target;s((()=>{const{scrollTop:t,clientHeight:i,scrollHeight:a}=e;t+i+10>=a?(this.autoScrollEnabled=!0,this.showLatestMessageButton=!1):this.autoScrollEnabled=!1}))},this.scrollToBottom=()=>{m(this.$chat)},this.observeMessage=t=>{t&&this.observingEl.push(t);try{this.intersectionObserver.observe(t)}catch(t){}},this.getMessageActions=t=>{const e=[];return!t.pinned&&this.canPinMessages&&e.push({id:"pin_message",label:this.t("pin"),icon:this.iconPack.pin}),e},this.onMessageActionHandler=(t,e)=>{"pin_message"===t&&this.onPinMessage.emit(e)}}connectedCallback(){var t;this.lastReadTimestamp=null!==(t=h.everyone)&&void 0!==t?t:new Date("0001-01-01T00:00:00Z"),this.intersectionObserver=new IntersectionObserver((t=>{document.hasFocus()&&s((()=>{for(const e of t)e.isIntersecting&&parseInt(e.target.getAttribute("data-timestamp"))>this.lastReadTimestamp.getTime()&&(h[this.selectedGroup]=new Date)}))}));const e=()=>{this.now=new Date,this.timeout=setTimeout((()=>{null!=this.request&&(this.request=requestAnimationFrame(e))}),6e4)};this.request=requestAnimationFrame(e),this.chatChanged(this.messages)}componentDidLoad(){this.$chat.addEventListener("scroll",this.onScroll),this.$chat.scrollTop=this.$chat.scrollHeight}componentDidRender(){this.autoScrollEnabled?m(this.$chat):null==this.autoScrollEnabled&&m(this.$chat,!1)}chatChanged(t){if(null!=this.$chat&&!this.autoScrollEnabled&&this.$chat.clientHeight!==this.$chat.scrollHeight)for(let e=t.length-1;e>=0;e--)if(t[e].message.time>this.lastReadTimestamp&&t[e].message.userId!==this.selfUserId){this.showLatestMessageButton=!0;break}}selectedBucketChanged(){this.autoScrollEnabled=void 0,this.observingEl.forEach((t=>{this.intersectionObserver.unobserve(t)})),this.observingEl=[]}disconnectedCallback(){this.$chat.removeEventListener("scroll",this.onScroll),this.intersectionObserver.disconnect(),clearTimeout(this.timeout),cancelAnimationFrame(this.request)}render(){var t;let e=null,n=!1;return i(a,{key:"bc93fd8c3c99f926f02201c56097a1deac83d68f"},i("div",{key:"228a060e6e15b7b643ac75623c560cde6e7a94c8",class:"chat-container scrollbar",ref:t=>this.$chat=t,part:"container"},i("div",{key:"03b4ee2b9c60ac6e83162e6d4b6498c4742ffd24",class:"spacer",part:"spacer"}),i("div",{key:"41e08c58b33006857fc488654ee80e44d7587cee",class:"chat",part:"chat"},null===(t=this.messages)||void 0===t?void 0:t.map((t=>{if("chat"===t.type){const{message:a}=t,s=!(a.userId===this.selfUserId)&&!this.autoScrollEnabled&&!n&&a.time>this.lastReadTimestamp;s&&(n=s);const r=!s&&a.userId===(null==e?void 0:e.userId)&&v(a.time,null==e?void 0:e.time)<2;return e=a,i("div",{"is-continued":r,key:t.message.id,ref:this.observeMessage,"data-timestamp":a.time.getTime(),class:a.pinned?"pinned":""},s&&i("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),i("div",{class:"message-wrapper"},i("dyte-message-view",{time:a.time,actions:this.getMessageActions(a),authorName:a.displayName,hideAuthorName:!0,hideAvatar:!0,hideMetadata:!0,viewType:"incoming",variant:"bubble",onAction:t=>this.onMessageActionHandler(t.detail,a)},i("div",null,!r&&i("div",{class:"head"},i("div",{class:"name"},a.displayName),!!a.time&&i("div",{class:"time",title:u(a.time)},f(a.time,new Date(Date.now())))),i("div",{class:"body"},"text"===a.type&&i("dyte-text-message-view",{text:a.message,isMarkdown:!0}),"file"===a.type&&i("dyte-file-message-view",{name:a.name,url:a.link,size:a.size}),"image"===a.type&&i("dyte-image-message-view",{url:a.link,onPreview:()=>{this.stateUpdate.emit({image:a}),o.image=a}})))),a.pinned&&i("div",{class:"pin-button",part:"pin-button"},i("dyte-tooltip",{label:this.t("unpin")},i("dyte-button",{kind:"icon",variant:"ghost",onClick:()=>this.onMessageActionHandler("pin_message",a),disabled:!this.canPinMessages},i("dyte-icon",{icon:this.iconPack.pin,size:"sm"}))))))}return null})))),i("div",{key:"aae98c94debcf8ce7c3d2ef84e864c4159193dc1",class:"show-new-messages-ctr"},i("dyte-button",{key:"c784b8ef379a3fdd677698f2307f954e38122c92",class:{"show-new-messages":!0,active:this.showLatestMessageButton},kind:"icon",part:"show-new-messages",onClick:this.scrollToBottom},i("dyte-icon",{key:"5b2bd03349a92984ba169cbbe30196f071f86a71",icon:this.iconPack.chevron_down}))))}static get watchers(){return{messages:["chatChanged"],selectedGroup:["selectedBucketChanged"]}}};P([p()],q.prototype,"iconPack",void 0),P([p()],q.prototype,"t",void 0),q.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));word-break:break-word}.chat-container{box-sizing:border-box;display:flex;flex-direction:column;padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);flex:1 0 0px;overflow-y:scroll}.chat-container .spacer{flex:1 1 auto}.chat-container .chat{flex:0 0 auto}.file-picker{display:none}.chat .head{display:flex;align-items:center}.chat .head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.chat .head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat .body{margin-top:var(--dyte-space-2, 8px);overflow-wrap:break-word;line-height:1.375}.chat .body .emoji{font-size:24px}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-message-view{margin-top:var(--dyte-space-4, 16px);display:block;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}dyte-message-view::part(message){flex-grow:1}*[is-continued] dyte-message-view{margin-top:var(--dyte-space-1, 4px)}.pinned .message-wrapper{position:relative}.pinned .pin-button{position:absolute;right:var(--dyte-space-4, 16px);top:calc(var(--dyte-space-4, 16px) * -1);display:flex;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.pinned .pin-button:hover dyte-button{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-bg-opacity))}.pinned dyte-message-view{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));text-decoration-line:none}a:hover{text-decoration-line:underline}.new-chat-marker{display:flex;width:100%;align-items:center;gap:var(--dyte-space-2, 8px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.new-chat-marker::before{content:'';height:1px;flex:1 1 0%;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.show-new-messages-ctr{pointer-events:none;display:flex;justify-content:flex-end;padding:var(--dyte-space-3, 12px);z-index:0;margin-top:calc(var(--dyte-space-14, 56px) * -1)}.show-new-messages{pointer-events:auto;--tw-translate-y:var(--dyte-space-16, 64px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}";var S=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};const T=class{constructor(a){t(this,a),this.editMessageInit=e(this,"editMessageInit",7),this.onPinMessage=e(this,"pinMessage",7),this.onDeleteMessage=e(this,"deleteMessage",7),this.stateUpdate=e(this,"dyteStateUpdate",7),this.iconPack=d,this.t=c(),this.leftAlign=!1,this.permissionsChanged=!1,this.pageSize=25,this.lastReadMessageIndex=-1,this.permissionsUpdateListener=()=>{this.permissionsChanged=!this.permissionsChanged},this.maybeMarkChannelAsRead=t=>{if(!this.selectedChannelId)return;if(0===t.length)return;if(-1!==this.lastReadMessageIndex)return;const e=t.at(0).time>t.at(-1).time?t.at(0):t.at(-1);e.channelIndex&&(this.lastReadMessageIndex=parseInt(e.channelIndex,10),this.meeting.chat.markLastReadMessage(this.selectedChannelId,e))},this.getChatMessages=async(t,e,i)=>{const{messages:a}=await this.meeting.chat.getMessages(t,e,i,void 0,this.selectedChannelId);return this.maybeMarkChannelAsRead(a),a},this.createChatNodes=t=>t.map(((e,i)=>{var a;const n=e.userId===(null===(a=t[i-1])||void 0===a?void 0:a.userId);return this.createChatNode(e,n)})),this.disconnectMeeting=t=>{var e,i;null===(e=null==t?void 0:t.chat)||void 0===e||e.removeListener("chatUpdate",this.chatUpdateListener),null===(i=this.meeting)||void 0===i||i.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener)},this.getMessageActions=t=>{const e=[];return this.meeting.self.permissions.pinParticipant&&e.push({id:"pin_message",label:this.t(t.pinned?"unpin":"pin"),icon:this.iconPack.pin}),e},this.onMessageActionHandler=(t,e)=>{switch(t){case"pin_message":this.onPinMessage.emit(e);break;case"delete_message":this.onDeleteMessage.emit(e)}},this.createChatNode=(t,e)=>{var a,n,s,r;if(0!==t.targetUserIds.length)return null;let d;return d="CHAT"===this.meeting.meta.viewType?null===(a=this.meeting.participants.all.toArray().find((e=>e.userId===t.userId)))||void 0===a?void 0:a.picture:this.meeting.self.userId===t.userId?this.meeting.self.picture:null!==(s=null===(n=this.meeting.participants.joined.toArray().find((e=>e.userId===t.userId)))||void 0===n?void 0:n.picture)&&void 0!==s?s:null===(r=this.meeting.participants.waitlisted.toArray().find((e=>e.userId===t.userId)))||void 0===r?void 0:r.picture,i("div",{class:{pinned:t.pinned}},i("div",{class:"message-wrapper"},i("dyte-message-view",{time:t.time,actions:this.getMessageActions(t),authorName:t.displayName,avatarUrl:d,hideAuthorName:e,viewType:"incoming",variant:"bubble",onAction:e=>this.onMessageActionHandler(e.detail,t)},i("div",null,i("div",{class:"body"},"text"===t.type&&i("dyte-text-message-view",{text:t.message,isMarkdown:!0}),"file"===t.type&&i("dyte-file-message-view",{name:t.name,url:t.link,size:t.size}),"image"===t.type&&i("dyte-image-message-view",{url:t.link,onPreview:()=>{this.stateUpdate.emit({image:t}),o.image=t}})),t.pinned&&i("div",{class:"pin-icon",part:"pin-icon"},i("dyte-icon",{icon:this.iconPack.pin,size:"sm"}))))))},this.chatUpdateListener=t=>{this.selectedChannelId&&t.message.channelId!==this.selectedChannelId||("add"===t.action?(this.$paginatedListRef.onNewNode(t.message),this.lastReadMessageIndex=-1,this.maybeMarkChannelAsRead([t.message])):"delete"===t.action?this.$paginatedListRef.onNodeDelete(t.message.id):"edit"===t.action&&this.$paginatedListRef.onNodeUpdate(t.message.id,t.message))}}componentDidLoad(){const t=this.host.shadowRoot.querySelector("slot");t&&(this.children=t.assignedElements()[0])}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(t,e){var i;null!=e&&this.disconnectMeeting(e),t&&!t.chat||(null!=t&&(null===(i=t.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener),t.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)),this.permissionsUpdateListener())}channelChanged(){this.lastReadMessageIndex=-1}render(){return i(a,{key:"260faffd9f162ce5b1658f46ee42c4d94204b6da"},i("dyte-paginated-list",{key:"01ff7aec9526a8d6adf21e5ab8509e2c540f3055",ref:t=>this.$paginatedListRef=t,pageSize:this.pageSize,pagesAllowed:3,fetchData:this.getChatMessages,createNodes:this.createChatNodes,selectedItemId:this.selectedChannelId,emptyListLabel:this.t("chat.empty_channel")},i("slot",{key:"9efe877f17f168f0fc1fe7d87175b17c43282291"})))}get host(){return n(this)}static get watchers(){return{meeting:["meetingChanged"],selectedChannelId:["channelChanged"]}}};S([p()],T.prototype,"meeting",void 0),S([p()],T.prototype,"iconPack",void 0),S([p()],T.prototype,"t",void 0),T.style=":host{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));flex:1 0 0px}";var A=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};const U=class{constructor(e){t(this,e),this.iconPack=d,this.t=c(),this.pageSize=50,this.searchMessages=async(t,e,i)=>this.meeting.chat.searchMessages(this.query,{channelId:this.channelId,timestamp:t,size:e,reversed:i}),this.nodeRenderer=t=>t.map((t=>i("dyte-chat-message",{key:t.id,message:t,disableControls:!0})))}render(){return i(a,{key:"984a388e6c194e27c5cb7918806bd9f156220ec7"},i("dyte-paginated-list",{key:"444fa000de6428b4c0c6e0c829eb4ef944d2a211",pageSize:this.pageSize,pagesAllowed:3,fetchData:this.searchMessages,createNodes:this.nodeRenderer,selectedItemId:this.query}))}};A([p()],U.prototype,"meeting",void 0),A([p()],U.prototype,"iconPack",void 0),A([p()],U.prototype,"t",void 0),U.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;flex-direction:column;position:relative;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}";var M=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};const E=class{constructor(i){t(this,i),this.stateUpdate=e(this,"dyteStateUpdate",7),this.config=x,this.states=o,this.iconPack=d,this.t=c(),this.updateStoreState=(t,e)=>{o[t]=e,this.stateUpdate.emit({[t]:e})},this.cancelJoinStage=async()=>{var t,e,i;"ACCEPTED_TO_JOIN_STAGE"===(null===(t=this.meeting.stage)||void 0===t?void 0:t.status)&&await(null===(i=null===(e=this.meeting)||void 0===e?void 0:e.stage)||void 0===i?void 0:i.leave()),this.updateStoreState("activeJoinStage",!1)},this.joinStage=async()=>{await this.meeting.stage.join()},this.stageStatusUpdateListener=t=>{var e;((null===(e=this.states)||void 0===e?void 0:e.activeJoinStage)||o.activeJoinStage)&&"ON_STAGE"===t&&this.updateStoreState("activeJoinStage",!1)}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var t;null===(t=this.meeting.stage)||void 0===t||t.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)}meetingChanged(t){if(null==t)return;const{stage:e}=t;null==e||e.addListener("stageStatusUpdate",this.stageStatusUpdateListener)}render(){var t,e,n,s;const r={meeting:this.meeting,states:this.states||o,config:this.config,size:this.size,iconPack:this.iconPack,t:this.t},d=this.states||o;if(null!=(null==d?void 0:d.image)){const t=()=>{this.stateUpdate.emit({image:null}),o.image=null};return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:t,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-image-viewer",defaults:r,props:{image:d.image,onClose:t}})))}if(!0===(null==d?void 0:d.activeSettings))return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeSettings",!1),iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-settings",defaults:r})));if(!0===(null==d?void 0:d.activeDebugger))return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeDebugger",!1),iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-debugger",defaults:r})));if(!0===(null==d?void 0:d.activeLeaveConfirmation))return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeLeaveConfirmation",!1),iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-leave-meeting",defaults:r})));if(!0===(null===(t=null==d?void 0:d.activePermissionsMessage)||void 0===t?void 0:t.enabled))return i(a,null,i("dyte-dialog",{open:!0,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-permissions-message",defaults:r})));if(!0===(null==d?void 0:d.activeRemoteAccessManager))return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeRemoteAccessManager",!1),iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-remote-access-manager",defaults:r})));if(!0===(null===(e=null==d?void 0:d.activeBreakoutRoomsManager)||void 0===e?void 0:e.active))return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBreakoutRoomsManager",{active:!1,data:void 0}),iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-breakout-rooms-manager",defaults:r,props:{mode:this.meeting.connectedMeetings.isActive?"view":"create"}})));if(!0===(null===(n=null==d?void 0:d.activeConfirmationModal)||void 0===n?void 0:n.active))return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeConfirmationModal",!1),iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-confirmation-modal",defaults:r})));if(!0===(null===(s=null==d?void 0:d.activeOverlayModal)||void 0===s?void 0:s.active))return i(a,null,i("dyte-overlay-modal",{meeting:this.meeting,states:this.states,iconPack:this.iconPack,t:this.t}));if(null==d?void 0:d.activeBroadcastMessageModal)return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBroadcastMessageModal",!1),iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-broadcast-message-modal",defaults:r})));if(!0===(null==d?void 0:d.activeJoinStage)){const t={title:this.t("stage.join_title"),label:{accept:this.t("stage.join_confirm"),reject:this.t("stage.join_cancel")},description:this.t("stage.join_summary")};return i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:this.cancelJoinStage,iconPack:this.iconPack,t:this.t},i("dyte-join-stage",Object.assign({dataConfig:t,onDyteJoinStage:this.joinStage,onDyteLeaveStage:this.cancelJoinStage},r))))}return!0===(null==d?void 0:d.activeMuteAllConfirmation)?i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeMuteAllConfirmation",!1)},iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-mute-all-confirmation",defaults:r}))):(null==d?void 0:d.activeChannelCreator)?i(a,null,i("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeChannelCreator",!1)},iconPack:this.iconPack,t:this.t},i(w,{element:"dyte-channel-creator",defaults:r}))):null}static get watchers(){return{meeting:["meetingChanged"]}}};M([p()],E.prototype,"meeting",void 0),M([p()],E.prototype,"states",void 0),M([p()],E.prototype,"iconPack",void 0),M([p()],E.prototype,"t",void 0),E.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";const L=2e3,I=Object.freeze({notifications:{participant_joined:!0,participant_left:!0,participant_joined_waitlist:!0,chat:!0,polls:!0,webinar:!0,tab_sync:!0,recording_started:!0,recording_stopped:!0},notification_sounds:{participant_joined:!0,participant_left:!0,chat:!0,polls:!0,webinar:!0,participant_joined_waitlist:!0},notification_duration:{participant_joined:2100,participant_left:2100,participant_joined_waitlist:4e3,chat:L,polls:L,webinar:L,tab_sync:L,recording_started:L,recording_stopped:L},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10});var N=function(t,e,i,a){var n,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};function J(t){return Object.keys(t).filter((e=>t[e]))}const G=class{constructor(e){t(this,e),this.permissions=I,this.enabledSounds=J(I.notification_sounds),this.config=x,this.t=c(),this.iconPack=d,this.notifications=[],this.addStagePeersListeners=t=>{t.participants.joined.addListener("participantJoined",this.participantJoinedListener),t.participants.joined.addListener("participantLeft",this.participantLeftListener)},this.removeStagePeersListeners=t=>{t.participants.joined.removeListener("participantJoined",this.participantJoinedListener),t.participants.joined.removeListener("participantLeft",this.participantLeftListener)},this.onDyteNotification=t=>{this.add(t.detail);const e=t.detail.playSound;null!=e&&this.audio.play(e)},this.onRecordingUpdate=t=>{var e,i;"RECORDING"===t&&!1!==this.permissions.notifications.recording_started?this.add({id:"recording-started",icon:this.iconPack.recording,message:this.t("recording.started"),duration:null!==(e=this.permissions.notification_duration.recording_started)&&void 0!==e?e:L}):"STOPPING"===t&&!1!==this.permissions.notifications.recording_stopped&&this.add({id:"recording-stopped",icon:this.iconPack.stop_recording,message:this.t("recording.stopped"),duration:null!==(i=this.permissions.notification_duration.recording_stopped)&&void 0!==i?i:L})}}connectedCallback(){"undefined"!=typeof document&&(null===document||void 0===document||document.addEventListener("dyteNotification",this.onDyteNotification)),this.meetingChanged(this.meeting),this.configChanged(this.config),this.statesChanged(this.states)}clearListeners(t){var e,i,a,n,s,o,r,d;const c="LIVESTREAM"===t.meta.viewType;(c&&"ON_STAGE"===(null===(e=t.stage)||void 0===e?void 0:e.status)||!c)&&this.removeStagePeersListeners(t),this.chatUpdateListener&&(null===(i=t.chat)||void 0===i||i.removeListener("chatUpdate",this.chatUpdateListener)),this.pollUpdateListener&&(null===(a=t.polls)||void 0===a||a.removeListener("pollsUpdate",this.pollUpdateListener)),t.meta.removeListener("socketConnectionUpdate",this.socketConnectionUpdateListener),this.stageRequestAccepted&&(null===(n=t.stage)||void 0===n||n.removeListener("stageRequestApproved",this.stageRequestAccepted)),this.stageRequestRejected&&(null===(s=t.stage)||void 0===s||s.removeListener("stageRequestRejected",this.stageRequestRejected)),this.newStageRequests&&(null===(o=t.stage)||void 0===o||o.removeListener("newStageRequest",this.newStageRequests)),this.stageStatusUpdateListener&&(null===(r=t.stage)||void 0===r||r.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)),null===(d=t.recording)||void 0===d||d.removeListener("recordingUpdate",this.onRecordingUpdate),clearTimeout(this.disconnectTimeout),t.self.removeListener("deviceUpdate",this.deviceUpdateListener)}disconnectedCallback(){var t;"undefined"!=typeof document&&(null===document||void 0===document||document.removeEventListener("dyteNotification",this.onDyteNotification)),null!=this.meeting&&(this.clearListeners(this.meeting),this.waitlistedParticipantJoinedListener&&this.meeting.participants.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.waitlistedParticipantLeftListener&&this.meeting.participants.waitlisted.removeListener("participantLeft",this.waitlistedParticipantLeftListener),this.activeTabUpdateListener&&(null===(t=this.meeting.meta)||void 0===t||t.removeListener("activeTabUpdate",this.activeTabUpdateListener)),this.peerStageStatusListener&&this.meeting.participants.joined.removeListener("stageStatusUpdate",this.peerStageStatusListener))}meetingChanged(t,e){var i,a,n,s,o,d,c,l,h;if(clearTimeout(this.disconnectTimeout),void 0!==e&&this.clearListeners(e),null==t)return;const p="LIVESTREAM"===t.meta.viewType;this.audio=new k(t);const{notifications:b,notification_duration:g,notification_sounds:v}=this.permissions;if(this.participantJoinedListener=t=>{b.participant_joined&&this.add({id:`${t.id}-joined`,message:`${j(t.name)} ${this.t("notifications.joined")}`,image:t.picture,duration:g.participant_joined}),v.participant_joined&&this.canPlayParticipantJoinedSound()&&this.audio.play("joined")},this.participantLeftListener=t=>{const{socketState:{state:e}}=this.meeting.meta;b.participant_left&&"connected"!==e&&this.add({id:`${t.id}-left`,message:`${j(t.name)} ${this.t("notifications.left")}`,image:t.picture,duration:g.participant_left}),v.participant_left&&this.canPlayParticipantJoinedSound()&&this.audio.play("left")},this.waitlistedParticipantJoinedListener=t=>{if(!this.canAcceptWaitingRequests())return;const e=`${t.id}-joined-waitlist`;this.add({id:e,message:`${j(t.name)} ${this.t("notifications.requesting_to_join_meeting")}`,image:t.picture,duration:g.participant_joined_waitlist,button:{text:this.t("notifications.accept"),variant:"primary",onClick:async()=>{await this.meeting.participants.acceptWaitingRoomRequest(t.id),this.remove(e)}}}),v.participant_joined_waitlist&&this.canPlayParticipantJoinedSound()&&this.audio.play("message")},this.waitlistedParticipantLeftListener=t=>{this.remove(`${t.id}-joined-waitlist`)},this.chatUpdateListener=({message:e})=>{const i=y(e);if(null!=i){if(i.userId===t.self.userId)return;"text"===i.type&&(b.chat&&this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${i.displayName}: ${i.message}`,duration:g.chat}),v.chat&&this.canPlayChatSound()&&this.audio.play("message"))}},this.pollUpdateListener=({polls:t,newPoll:e})=>{!1!==e&&(b.polls&&this.meeting.self.userId!==t[t.length-1].createdByUserId&&this.add({id:`poll-${Math.random().toString(36)}`,icon:this.iconPack.poll,message:`${this.t("notifications.new_poll_created_by")} ${t[t.length-1].createdBy}`,duration:g.polls}),v.polls&&this.meeting.self.userId!==t[t.length-1].createdByUserId&&this.canPlayChatSound()&&this.audio.play("message"))},this.deviceUpdateListener=({device:t,preview:e})=>{e||("audiooutput"===t.kind&&(this.audio.setDevice(t.deviceId),this.remove("speaker-switched"),this.add({id:"speaker-switched",message:`${this.t("notifications.connected_to")} ${t.label}`,icon:this.iconPack.speaker,duration:5e3})),"videoinput"===t.kind&&(this.remove("camera-switched"),this.add({id:"camera-switched",message:`${this.t("notifications.connected_to")} ${t.label}`,icon:this.meeting.self.videoEnabled?this.iconPack.video_on:this.iconPack.video_off,iconVariant:this.meeting.self.videoEnabled?"primary":"danger",duration:5e3})),"audioinput"===t.kind&&(this.remove("mic-switched"),this.add({id:"mic-switched",message:`${this.t("notifications.connected_to")} ${t.label}`,icon:this.meeting.self.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off,iconVariant:this.meeting.self.audioEnabled?"primary":"danger",duration:5e3})))},this.socketConnectionUpdateListener=({state:t,reconnectionAttempt:e,reconnected:i})=>{switch(t){case"connected":this.remove("socket"),i&&this.add({id:"socket",icon:this.iconPack.wifi,message:this.t("network.restored"),duration:3e3});break;case"disconnected":this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.reconnecting")});break;case"reconnecting":e>=6?(this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.disconnected"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var t;return null===(t=this.meeting)||void 0===t?void 0:t.leaveRoom()}}})):e>=4&&(this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.delay_extended")}));break;case"failed":this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.leaving"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var t;return null===(t=this.meeting)||void 0===t?void 0:t.leaveRoom()}}})}},this.activeTabUpdateListener=e=>{if(b.tab_sync)switch(e.type){case"plugin":const i=t.plugins.active.toArray().find((t=>t.id==e.id));null!=i&&this.add({id:"activeTab",message:`${this.t("notifications.plugin_switched_to")} ${i.name}`,duration:g.participant_joined});break;case"screenshare":const a=t.participants.joined.toArray().filter((t=>t.screenShareEnabled)).find((t=>t.id==e.id));null!=a&&this.add({id:"spotlight",message:`Now watching ${a.name}'s screen`,duration:g.webinar})}},this.peerStageStatusListener=t=>{"REQUESTED_TO_JOIN_STAGE"===t.stageStatus&&(this.add({id:`stage-request-${t.id}`,message:`${t.name} ${this.t("notifications.requested_to_join_stage")}`,duration:g.webinar,button:{text:this.t("notifications.accept"),variant:"primary",onClick:async()=>{await this.meeting.stage.grantAccess([t.userId]),this.remove(`stage-request-${t.id}`)}}}),v.webinar&&this.audio.play("joined")),"ON_STAGE"===t.stageStatus&&(this.add({id:`stage-joined-${t.id}`,message:`${t.name} ${this.t("notifications.joined_stage")}`,duration:g.webinar}),v.webinar&&this.audio.play("joined"))},this.stageRequestAccepted=()=>{this.add({id:"stage-request-accepted",message:this.t("notifications.request_to_join_accepted"),duration:3e3})},this.stageRequestRejected=()=>{this.add({id:"stage-request-rejected",message:this.t("notifications.request_to_join_rejected"),duration:3e3})},this.newStageRequests=({count:t})=>{this.add({id:"new-stage-request",message:`You have ${t<0?"new stage":`${t} pending`} request${1===t?"":"s"}`,duration:3e3})},this.stageStatusUpdateListener=e=>{"ON_STAGE"===e?this.addStagePeersListeners(t):this.removeStagePeersListeners(t)},!r(t)&&(null===(i=t.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener)),"CHAT"===(null===(a=t.self.config.viewType)||void 0===a?void 0:a.toString()))return;const u=t.self.getCurrentDevices();null!=u.speaker&&this.audio.setDevice(u.speaker.deviceId),p?null===(n=t.stage)||void 0===n||n.on("stageStatusUpdate",this.stageStatusUpdateListener):this.addStagePeersListeners(t),this.canAcceptWaitingRequests()&&(t.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),t.participants.waitlisted.addListener("participantLeft",this.waitlistedParticipantLeftListener)),null===(s=t.polls)||void 0===s||s.addListener("pollsUpdate",this.pollUpdateListener),t.self.addListener("deviceUpdate",this.deviceUpdateListener),t.meta.addListener("socketConnectionUpdate",this.socketConnectionUpdateListener),null===(o=t.meta)||void 0===o||o.addListener("activeTabUpdate",this.activeTabUpdateListener),null===(d=t.recording)||void 0===d||d.addListener("recordingUpdate",this.onRecordingUpdate),null===(c=t.stage)||void 0===c||c.addListener("stageRequestApproved",this.stageRequestAccepted),null===(l=t.stage)||void 0===l||l.addListener("stageRequestRejected",this.stageRequestRejected),t.self.permissions.stageEnabled&&t.self.permissions.acceptStageRequests&&(null===(h=t.stage)||void 0===h||h.addListener("newStageRequest",this.newStageRequests))}configChanged(t){null!=t&&null!=(null==t?void 0:t.config)&&(this.permissions=function(t){const e=Object.assign({},I);return null==t||(Object.assign(e.notification_sounds,t.notification_sounds),Object.assign(e.notifications,t.notifications),Object.assign(e.notification_duration,t.notification_duration),e.participant_chat_message_sound_notification_limit=t.participant_chat_message_sound_notification_limit,e.participant_joined_sound_notification_limit=t.participant_joined_sound_notification_limit),e}(t.config),this.enabledSounds=J(this.permissions.notification_sounds))}statesChanged(t){var e;if(null!=t){const i=!(null===(e=null==t?void 0:t.prefs)||void 0===e?void 0:e.muteNotificationSounds);for(const t of this.enabledSounds)t in this.permissions.notification_sounds&&(this.permissions.notification_sounds[t]=i)}}apiErrorListener({detail:t}){const{trace:e,message:i}=t;this.add({id:e,message:i,duration:L,icon:this.iconPack.warning})}sendNotificationListener({detail:t}){const{trace:e,message:i}=t;this.add({id:e,message:i,duration:L})}add(t){"visible"===document.visibilityState&&this.notifications.length<5&&(this.notifications=[...this.notifications,t])}remove(t){this.notifications=this.notifications.filter((e=>e.id!==t))}handleDismiss(t){t.stopPropagation();const e=t.detail,i=this.host.shadowRoot.querySelector(`[data-id="${e}"]`);null==i||i.classList.add("exit"),setTimeout((()=>{s((()=>{this.remove(e)}))}),400)}canPlayParticipantJoinedSound(){return null==this.permissions.participant_joined_sound_notification_limit||this.permissions.participant_joined_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_joined_sound_notification_limit}canPlayChatSound(){return null==this.permissions.participant_chat_message_sound_notification_limit||this.permissions.participant_chat_message_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_chat_message_sound_notification_limit}canAcceptWaitingRequests(){return this.permissions.notifications.participant_joined_waitlist&&this.meeting.self.permissions.acceptWaitingRequests}render(){return i(a,{key:"5f0333d5590fc6a2029925df73e3cf8e5008e207"},this.notifications.map((t=>i("dyte-notification",{size:this.size,key:t.id,"data-id":t.id,notification:t,onDyteNotificationDismiss:t=>this.handleDismiss(t),iconPack:this.iconPack,t:this.t}))))}get host(){return n(this)}static get watchers(){return{meeting:["meetingChanged"],config:["configChanged"],states:["statesChanged"]}}};N([p()],G.prototype,"meeting",void 0),N([p()],G.prototype,"states",void 0),N([p()],G.prototype,"t",void 0),N([p()],G.prototype,"iconPack",void 0),G.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;z-index:100}dyte-notification{margin-top:var(--dyte-space-2, 8px)}";export{C as dyte_channel_header,R as dyte_channel_selector_view,z as dyte_chat_composer_view,q as dyte_chat_messages_ui,T as dyte_chat_messages_ui_paginated,U as dyte_chat_search_results,E as dyte_dialog_manager,G as dyte_notifications}