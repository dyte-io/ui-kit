import{r as t,c as i,h as s,H as e,a}from"./p-aff91b47.js";import{d}from"./p-d5822e94.js";import{u as h}from"./p-bd6bca51.js";import{l as n,R as c}from"./p-fd4b6d8b.js";import{f as o,s as r}from"./p-338c7261.js";import{s as l}from"./p-c03ce358.js";import"./p-a03d57a1.js";import{d as p}from"./p-5a97005d.js";import"./p-a6712bf4.js";import{F as f}from"./p-bf38ee7f.js";import"./p-e497ad6d.js";import{c as b,a as m,o as y,s as v,h as u}from"./p-4ebfbb95.js";import"./p-ae02fe11.js";const g=class{constructor(s){t(this,s),this.dyteSendNotification=i(this,"dyteSendNotification",7),this.pinnedListener=({isPinned:t})=>{this.isPinned=t},this.toggleTileListener=({hidden:t})=>{this.isHidden=t},this.stageListener=({stageStatus:t})=>{this.isOnStage="ON_STAGE"===t},this.view="sidebar",this.iconPack=d,this.t=h(),this.config=p,this.audioEnabled=!1,this.videoEnabled=!1,this.isPinned=!1,this.isHidden=!1,this.isOnStage=!1,this.canDisableParticipantAudio=!1,this.canDisableParticipantVideo=!1,this.canKickParticipant=!1,this.canPinParticipant=!1,this.canAllowParticipantOnStage=!1,this.menuOpen=!1,this.permissionsUpdateListener=()=>{this.meetingChanged(this.meeting)},this.inviteToStageToggle=async()=>{const t=this.participant,{stage:i}=this.meeting;"ACCEPTED_TO_JOIN_STAGE"!==t.stageStatus?(this.isOnStage?(t.isPinned&&t.unpin(),await i.kick([t.userId])):(await i.grantAccess([t.userId]),this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-invite-${t.id}`})),this.isOnStage="ON_STAGE"===t.stageStatus):this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-${t.id}`})},this.handleOutsideClick=t=>{!t.composedPath().includes(this.host)&&this.menuOpen&&(this.menuOpen=!1)},this.update=()=>{const t=this.host.shadowRoot.getElementById("trigger"),i=this.host.shadowRoot.getElementById("menu-list");b(t,i,{placement:"bottom-end",middleware:[m({allowedPlacements:["bottom-end","top-end"],alignment:"end"}),y(4),v({padding:8}),u()]}).then((({x:t,y:s,placement:e})=>{let a=null;a="bottom-end"===e?{right:`${t}px`,top:`${s}px`}:{right:`${t}px`,bottom:`${s}px`},Object.assign(i.style,a)}))},this.onMenuToggle=()=>{this.menuOpen=!this.menuOpen,this.menuOpen&&this.update()}}connectedCallback(){this.meetingChanged(this.meeting),this.participantChanged(this.participant),document.addEventListener("click",this.handleOutsideClick)}disconnectedCallback(){var t;document.removeEventListener("click",this.handleOutsideClick),null===(t=this.meeting)||void 0===t||t.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener),null!=this.participant&&null!=this.participant.removeListener&&(this.audioUpdateListener&&this.participant.removeListener("audioUpdate",this.audioUpdateListener),this.videoUpdateListener&&this.participant.removeListener("videoUpdate",this.videoUpdateListener),this.participant.removeListener("pinned",this.pinnedListener),this.participant.removeListener("unpinned",this.pinnedListener),this.participant.removeListener("stageStatusUpdate",this.stageListener),this.participant.removeListener("toggleTile",this.toggleTileListener))}meetingChanged(t){var i,s,e,a,d,h,n;if(null!=t){const{self:c}=t;this.canDisableParticipantAudio=c.permissions.canAllowParticipantAudio||c.permissions.canDisableParticipantAudio,this.canDisableParticipantVideo=c.permissions.canAllowParticipantVideo||c.permissions.canDisableParticipantVideo,this.canKickParticipant=c.permissions.kickParticipant&&!0!==(null===(i=this.meeting)||void 0===i?void 0:i.__internals__.features.hasFeature(f.DISABLE_KICKING))&&(!0!==(null===(s=this.meeting)||void 0===s?void 0:s.__internals__.features.hasFeature(f.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(e=this.participant)||void 0===e?void 0:e.presetName)),this.canPinParticipant=c.permissions.pinParticipant,this.canAllowParticipantOnStage=c.permissions.acceptStageRequests&&c.permissions.stageEnabled&&(!0!==(null===(a=this.meeting)||void 0===a?void 0:a.__internals__.features.hasFeature(f.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(d=this.participant)||void 0===d?void 0:d.presetName))&&(!0!==(null===(h=this.meeting)||void 0===h?void 0:h.__internals__.features.hasFeature(f.CANTINVITE_VIEWER))||"webinar_viewer"!==(null===(n=this.participant)||void 0===n?void 0:n.presetName)),t.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)}}participantChanged(t){var i;if(null!=t){if(this.audioEnabled=t.audioEnabled,this.videoEnabled=t.videoEnabled,this.isPinned=t.isPinned,this.isHidden=null!==(i=t.hidden)&&void 0!==i&&i,this.isOnStage="ON_STAGE"===t.stageStatus,this.audioUpdateListener=({audioEnabled:t})=>{this.audioEnabled=t},this.videoUpdateListener=({videoEnabled:t})=>{this.videoEnabled=t},null==t.addListener)return;t.addListener("audioUpdate",this.audioUpdateListener),t.addListener("videoUpdate",this.videoUpdateListener),t.addListener("pinned",this.pinnedListener),t.addListener("unpinned",this.pinnedListener),t.addListener("stageStatusUpdate",this.stageListener),this.participant.addListener("toggleTile",this.toggleTileListener)}}render(){var t,i,a,d,h,p,f,b,m;const y="AUDIO_ROOM"===(null===(t=this.meeting)||void 0===t?void 0:t.meta.viewType),v=(null===(i=this.meeting)||void 0===i?void 0:i.self.id)===this.participant.id,u=this.canDisableParticipantAudio&&this.audioEnabled||this.canDisableParticipantVideo&&this.videoEnabled&&!y||this.canKickParticipant||this.canPinParticipant&&this.isOnStage||this.canAllowParticipantOnStage,g=o((null===(a=this.participant)||void 0===a?void 0:a.name)||""),k=this.isOnStage||["GROUP_CALL","AUDIO_ROOM"].includes(null===(d=this.meeting)||void 0===d?void 0:d.meta.viewType),x={meeting:this.meeting,size:"sm",states:l,config:this.config,iconPack:this.iconPack,t:this.t};return s(e,{key:"afc9586301472422de9730c672d353bee9c9def9"},s("div",{class:"left",key:null===(h=this.participant)||void 0===h?void 0:h.id},s("dyte-avatar",{key:"a5cf02b13cab96f2fb49e52a43df4095db76da38",participant:this.participant,size:"sm",iconPack:this.iconPack,t:this.t}),s("p",{key:"90e3ec1d963da4ee7719e1a2f1d089037949e070",class:"name",title:g},r(g,16)," ",(null===(p=this.meeting)||void 0===p?void 0:p.self.id)===(null===(f=this.participant)||void 0===f?void 0:f.id)&&this.t("(you)"))),"sidebar"===this.view&&s("div",{key:"d457306fdea64d9b6701cd93b7e045662a61131c",class:"right"},k&&s("dyte-icon",{key:"73932829b0488295960e38bcdc37ec1ade34add3",class:{red:!this.audioEnabled},iconPack:this.iconPack,t:this.t,icon:this.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off}),k&&!y&&s("dyte-icon",{key:"6401cc87d69d42471b5cc8e121375d720e642b22",class:{red:!this.videoEnabled},iconPack:this.iconPack,t:this.t,icon:this.videoEnabled?this.iconPack.video_on:this.iconPack.video_off}),(u||n({element:"dyte-participant",defaults:x,childProps:{participant:this.participant}})>0)&&s("div",{key:"5418cd49664fdf1fcdd180bede830886479d306d",class:"menu"},s("span",{key:"b7d5b647d1092c24d5f4e24f6981ce2de148cbaf",id:"trigger",onClick:this.onMenuToggle},s("dyte-button",{key:"54c800e11a5112cf4286fb8d12175b5b75802cb0",variant:"ghost",kind:"icon",slot:"trigger",iconPack:this.iconPack,t:this.t},s("dyte-icon",{key:"084a0d3e3c1994eebca845b4feadb65fb24f210d",class:"more",icon:this.iconPack.more_vertical}))),s("span",{key:"a425216880032ec2a50a3aff1a2bbea841b4f9b1",id:"menu-list"},this.menuOpen&&s("dyte-menu-list",{key:"37b901d5e5e94fe7ad21300ea70ae6dda4d7f5f6",iconPack:this.iconPack,t:this.t},this.canPinParticipant&&k&&!y&&s("dyte-menu-item",{key:"d8c3bb6ce6e10f4a5040eee95659c2b208657ee9",onClick:()=>{this.isPinned?this.participant.unpin():this.participant.pin()},iconPack:this.iconPack,t:this.t},s("dyte-icon",{key:"a965d52b112412d778448385aff9e4861d43c12c",icon:this.isPinned?this.iconPack.pin_off:this.iconPack.pin,slot:"start",iconPack:this.iconPack,t:this.t}),this.t(this.isPinned?"unpin":"pin")),v&&s("dyte-menu-item",{key:"4dd5a312098c0b127a8f3028f8c3b1fa87a6b846",iconPack:this.iconPack,t:this.t,onClick:()=>{this.isHidden?this.participant.show():this.participant.hide()}},s("dyte-icon",{key:"68aaa48b29e3eac636a108ace498ca72abe8f030",icon:this.isHidden?this.iconPack.minimize:this.iconPack.maximize,slot:"start"}),this.t(this.meeting.self.hidden?"maximize":"minimize")),this.canDisableParticipantAudio&&k&&this.audioEnabled&&s("dyte-menu-item",{key:"c2b0ac52e29870dfcb21f4098414aa7fd41a866d",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableAudio()}},s("dyte-icon",{key:"8f5c1e8f73d18cc8718d89affbdfe4dffee0f1ff",icon:this.iconPack.mic_off,slot:"start"}),this.t("mute")),this.canDisableParticipantVideo&&k&&this.videoEnabled&&s("dyte-menu-item",{key:"2213795cae2687d272e1b1e1ff1a333501d9a209",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableVideo()}},s("dyte-icon",{key:"655166433cb53c6a19bd08f5dbce1d9638c4c66f",icon:this.iconPack.video_off,slot:"start",iconPack:this.iconPack,t:this.t}),this.t("participants.turn_off_video")),this.canAllowParticipantOnStage&&(null===(b=this.participant)||void 0===b?void 0:b.id)!==(null===(m=this.meeting)||void 0===m?void 0:m.self.id)&&s("dyte-menu-item",{key:"4c52f290455bda88821547df7da84aabe7951450",iconPack:this.iconPack,t:this.t,class:this.isOnStage?"red":"",onClick:this.inviteToStageToggle},s("dyte-icon",{key:"02870ccaeb120433d91c4eccc8584dc341a9f97b",iconPack:this.iconPack,t:this.t,icon:this.isOnStage?this.iconPack.leave_stage:this.iconPack.join_stage,slot:"start"}),this.t(this.isOnStage?"stage.remove_from_stage":"stage.add_to_stage")),!v&&this.canKickParticipant&&s("dyte-menu-item",{key:"1fc701e879da2dac864e5e6efae7ea4c1ab8c0a2",iconPack:this.iconPack,t:this.t,class:"red",onClick:()=>{var t,i;null===(t=this.meeting)||void 0===t||t.participants.kick(null===(i=this.participant)||void 0===i?void 0:i.id)}},s("dyte-icon",{key:"9c8d0932bad1c28a82f5ed1474b1664009ed567b",icon:this.iconPack.dismiss,slot:"start",iconPack:this.iconPack,t:this.t}),this.t("kick")),s("slot",{key:"a55368c3f76fcb909831bbee4ff0b0d501d154c2"},s(c,{key:"8151d7756e7a3ec4474a566d752b64639dceb87e",element:"dyte-participant",defaults:x,childProps:{participant:this.participant},deepProps:!0,onlyChildren:!0})))))))}get host(){return a(this)}static get watchers(){return{meeting:["meetingChanged"],participant:["participantChanged"]}}};g.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;height:var(--dyte-space-14, 56px);align-items:center;justify-content:space-between;cursor:pointer;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}:host dyte-avatar{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);font-size:14px}.left{display:flex;align-items:center}.left>*{margin-right:var(--dyte-space-2, 8px)}.left>*:last-child{margin-right:var(--dyte-space-0, 0px)}.right{display:flex;align-items:center;justify-content:flex-end}.right>*{margin-left:var(--dyte-space-2, 8px)}.right>*:first-child{margin-left:var(--dyte-space-0, 0px)}.name{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}dyte-icon.red{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon.more{cursor:pointer}.menu{position:relative;display:inline-block;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}#menu-list{position:absolute;top:var(--dyte-space-8, 32px) !important;right:var(--dyte-space-4, 16px) !important;z-index:20}";export{g as dyte_participant}