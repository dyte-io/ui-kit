import{r as t,c as e,h as a,H as r,a as i,w as o}from"./p-aff91b47.js";import{d as s,u as d,s as c}from"./p-9362c375.js";import"./p-e497ad6d.js";import{S as n}from"./p-2fbb888d.js";import{C as l}from"./p-1d203b9f.js";import{a as p,h}from"./p-338c7261.js";import{g as b,a as y,d as g}from"./p-9fc565cf.js";import{s as v}from"./p-0752f2ba.js";import{d as f}from"./p-a08b5a59.js";import{T as m}from"./p-8e283e71.js";import"./p-382270d8.js";import"./p-2c3cda13.js";import"./p-83da1e09.js";var w=function(t,e,a,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,r);else for(var d=t.length-1;d>=0;d--)(i=t[d])&&(s=(o<3?i(s):o>3?i(e,a,s):i(e,a))||s);return o>3&&s&&Object.defineProperty(e,a,s),s};const x=class{constructor(r){t(this,r),this.edit=e(this,"edit",7),this.reply=e(this,"reply",7),this.pin=e(this,"pin",7),this.delete=e(this,"delete",7),this.iconPack=s,this.t=d(),this.isSelf=!1,this.canEdit=!1,this.canDelete=!1,this.canReply=!1,this.canPin=!1,this.disableControls=!1,this.alignRight=!1,this.hideAvatar=!1,this.now=new Date,this.leftAlign=!1,this.renderMessage=()=>{switch(this.message.type){case"text":return a("div",{"is-continued":this.isContinued,key:this.message.id},this.isUnread&&a("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),a("dyte-text-message",{message:this.message,now:this.now,isContinued:this.isContinued,"data-timestamp":this.message.time.getTime(),iconPack:this.iconPack,t:this.t,showBubble:!0}));case"image":return a("div",{"is-continued":this.isContinued,key:this.message.id},this.isUnread&&a("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),a("dyte-image-message",{message:this.message,now:this.now,isContinued:this.isContinued,iconPack:this.iconPack,"data-timestamp":this.message.time.getTime(),t:this.t,showBubble:!0}));case"file":return a("div",{"is-continued":this.isContinued,key:this.message.id},this.isUnread&&a("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),a("dyte-file-message",{message:this.message,now:this.now,isContinued:this.isContinued,iconPack:this.iconPack,t:this.t,"data-timestamp":this.message.time.getTime(),showBubble:!0}));case"custom":this.child.setAttribute("message",JSON.stringify(this.message));const t=this.child.cloneNode(!0);return a("div",{"is-continued":this.isContinued,key:this.message.id,ref:e=>e.appendChild(t)})}},this.onReply=()=>{this.reply.emit(this.message)},this.onPinned=()=>{this.pin.emit(this.message)},this.onDelete=()=>{this.delete.emit(this.message)},this.onEdit=async()=>{this.edit.emit(this.message)},this.isTouchDevice=()=>"ontouchstart"in window||navigator.maxTouchPoints>0}renderControls(){if(!this.disableControls)return a("dyte-menu",{placement:this.alignRight?"bottom-end":"bottom-start"},a("button",{slot:"trigger",class:"actions"},a("dyte-icon",{icon:this.iconPack.chevron_down})),a("dyte-menu-list",null,this.canReply&&a("dyte-menu-item",{onClick:this.onReply},a("dyte-icon",{icon:this.iconPack.back,slot:"start"}),this.t("chat.reply")),this.canPin&&a("dyte-menu-item",{onClick:this.onPinned},a("dyte-icon",{icon:this.iconPack.pin,slot:"start"}),this.t("pin")),this.canEdit&&a("dyte-menu-item",{onClick:this.onEdit},a("dyte-icon",{icon:this.iconPack.edit,slot:"start"}),this.t("chat.edit_msg")),this.canDelete&&a("dyte-menu-item",{onClick:this.onDelete},a("dyte-icon",{icon:this.iconPack.delete,slot:"start"}),this.t("chat.delete_msg"))))}renderAvatar(){if(!this.hideAvatar)return this.isContinued?a("div",{class:"avatar"}):a("div",{class:"avatar"},a("dyte-avatar",{size:"sm",participant:{name:this.message.displayName,picture:this.senderDisplayPicture}}))}render(){return a(r,{key:"55610c0442ed43102188c48449252ad44639902f"},a("div",{key:"5783638e4caeb95babddbfaf6cd9228f5bcb77c3",class:{"message-wrapper":!0,"align-right":this.alignRight,"left-align":this.leftAlign},"is-continued":this.isContinued},this.renderAvatar(),a("div",{key:"de42c3cc75d963a1cb990bde1f91cb009cd50a28",class:{message:!0,"show-on-hover":!this.isTouchDevice()},"is-continued":this.isContinued},this.renderMessage(),this.renderControls())))}get $el(){return i(this)}};w([n()],x.prototype,"iconPack",void 0),w([n()],x.prototype,"t",void 0),x.style=".message-wrapper{display:flex;gap:var(--dyte-space-2, 8px);margin-left:var(--dyte-space-4, 16px);margin-right:var(--dyte-space-4, 16px);margin-top:var(--dyte-space-4, 16px)}[is-continued] .message-wrapper{margin-top:var(--dyte-space-0, 0px)}.message-wrapper.align-right{flex-direction:row-reverse}.file-picker{display:none}.message{position:relative;display:flex}.show-on-hover dyte-menu{visibility:hidden}.show-on-hover:hover dyte-menu{visibility:visible}.align-right .message{justify-content:flex-end;margin-left:auto}.align-right .message .head{margin-right:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-0, 0px);flex-direction:row-reverse;gap:var(--dyte-space-4, 16px)}.align-right .message dyte-text-message .bubble,.align-right .message dyte-image-message .bubble,.align-right .message dyte-file-message .bubble{padding-right:var(--dyte-space-5, 20px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.align-right .message .actions dyte-icon{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.align-right dyte-menu{left:auto;right:var(--dyte-space-0, 0px)}.head{margin-bottom:var(--dyte-space-2, 8px);margin-left:var(--dyte-space-1, 4px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px)}.head .name{font-size:14px;font-weight:600}.head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}dyte-menu{position:absolute;left:var(--dyte-space-0, 0px);top:var(--dyte-space-6, 24px);border-radius:var(--dyte-border-radius-lg, 12px)}dyte-menu dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);cursor:pointer}[is-continued] dyte-menu{top:var(--dyte-space-2, 8px)}.actions{display:flex;align-items:center;justify-content:center;padding:var(--dyte-space-0\\.5, 2px);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent}.actions dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.body{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);overflow-wrap:break-word;font-size:14px;line-height:1.375}.body .emoji{font-size:24px}.body.bubble{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-1, 4px);max-width:var(--dyte-space-96, 384px);padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);padding-left:var(--dyte-space-5, 20px);padding-right:var(--dyte-space-5, 20px);overflow-wrap:break-word;font-size:14px;line-height:1.375;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.body.bubble p{margin:var(--dyte-space-0, 0px);word-break:break-word}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-text-message,dyte-image-message,dyte-file-message{display:block;font-family:var(--dyte-font-family, sans-serif);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}*[is-continued]{margin-top:var(--dyte-space-0, 0px)}.image{position:relative;height:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);cursor:pointer}.image img{display:none;height:100%;width:100%;border-radius:var(--dyte-border-radius-sm, 4px);-o-object-fit:cover;object-fit:cover}.image .image-spinner{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.image .image-spinner dyte-spinner{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.image .image-errored{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.1);--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.image .actions{display:none;height:var(--dyte-space-8, 32px);align-items:center;position:absolute;top:var(--dyte-space-2, 8px);right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.image .actions .action{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:var(--dyte-border-radius-none, 0);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.image .actions .action:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.image.loaded img{display:block}.image.loaded .image-spinner{display:none}.image:hover .actions,.image:focus .actions{display:flex}.file{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1\\.5, 6px);padding-bottom:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.file .file-data{flex:1 1 0%}.file .file-data .name{word-break:break-all;color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.file .file-data .file-data-split{margin-top:var(--dyte-space-0\\.5, 2px);display:flex;align-items:center;font-size:12px}.file .file-data .file-data-split .ext{margin-right:var(--dyte-space-2, 8px);text-transform:uppercase;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.file .file-data .file-data-split .divider{height:var(--dyte-space-4, 16px);width:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.file .file-data .file-data-split .size{margin-left:var(--dyte-space-2, 8px)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));text-decoration-line:none}a:hover{text-decoration-line:underline}.new-chat-marker{display:flex;width:100%;align-items:center;gap:var(--dyte-space-2, 8px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.new-chat-marker::before{content:'';height:1px;flex:1 1 0%;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.show-new-messages-ctr{pointer-events:none;display:flex;justify-content:flex-end;padding:var(--dyte-space-3, 12px);z-index:0;margin-top:calc(var(--dyte-space-14, 56px) * -1)}.show-new-messages{pointer-events:auto;--tw-translate-y:calc(var(--dyte-space-6, 24px) * -1);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}blockquote{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px);background-color:transparent}.block-quote,blockquote{--tw-border-spacing-x:1px;--tw-border-spacing-y:1px;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-top-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-none, 0);border-left-width:var(--dyte-border-width-md, 2px);border-right-width:var(--dyte-border-width-none, 0);border-style:solid;border-left-color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));padding:var(--dyte-space-0\\.5, 2px);padding-left:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px) !important;border-radius:var(--dyte-border-radius-sm, 4px);border-top-left-radius:var(--dyte-border-radius-none, 0);border-bottom-left-radius:var(--dyte-border-radius-none, 0)}.link{color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.align-right .block-quote{border-color:rgb(var(--dyte-colors-text-on-brand-600, var(--dyte-colors-text-600, 255 255 255 / 0.52)));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity))}.align-right .link{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.align-right .image .actions dyte-icon{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.avatar{display:flex;width:var(--dyte-space-6, 24px)}.avatar dyte-avatar{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px);font-size:10px}.message{width:75%}.left-align .body{margin-top:var(--dyte-space-4, 16px)}.left-align [is-continued] .body{margin-top:var(--dyte-space-0, 0px)}.left-align .body{--tw-translate-x:calc(var(--dyte-space-8, 32px) * -1);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}";var u=function(t,e,a,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,r);else for(var d=t.length-1;d>=0;d--)(i=t[d])&&(s=(o<3?i(s):o>3?i(e,a,s):i(e,a))||s);return o>3&&s&&Object.defineProperty(e,a,s),s};const k=class{constructor(e){t(this,e),this.now=new Date,this.isContinued=!1,this.iconPack=s,this.t=d(),this.showBubble=!1}render(){const t=p(this.message.link);return a(r,{key:"827816afbb7e2fe7a8271ed53b6b1ad53973a26f"},!this.isContinued&&a(l,{key:"4b0f50e8725ea204700e2fee0cde5c1a18c66f8b",name:this.message.displayName,time:this.message.time,now:this.now}),a("div",{key:"91357bce6fc62f8f7a4e3cb85a62ab6fc1130d4d",class:{body:!0,bubble:this.showBubble},part:"body"},a("div",{key:"6c239209ca644b9122157290c92d76b95b6ac871",class:"file"},a("div",{key:"0f61304357d1a8ccb9341fe2d43af15f2efebae7",class:"file-data"},a("div",{key:"0ac81343f80f20ff18a7361bfb350b7abb999698",class:"name"},this.message.name),a("div",{key:"acf5efc4cbce71382aca74f2a040aaad2f1960ca",class:"file-data-split"},a("div",{key:"9531a03968d473d457a64845ffc54a020604753c",class:"ext"},b(this.message.name)),a("span",{key:"3843a20ce91107a45b0274ecf40fcf82fe24fb9d",class:"divider"}),a("div",{key:"9cc92520365109185f50fc45bcfe4ec56e9ba286",class:"size"},y(this.message.size)))),a("dyte-button",{key:"ee2ba20a28a4545b372a7a35c83dcd5f87128310",variant:"secondary",kind:"icon",iconPack:this.iconPack,t:this.t,onClick:()=>g(t,{name:this.message.name,fallbackName:"file"}),part:"button"},a("dyte-icon",{key:"005f898fc15db2a0c2b23bed4e6483d6b2544013",icon:this.iconPack.download,iconPack:this.iconPack,t:this.t})))))}};u([n()],k.prototype,"iconPack",void 0),u([n()],k.prototype,"t",void 0);var j=function(t,e,a,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,r);else for(var d=t.length-1;d>=0;d--)(i=t[d])&&(s=(o<3?i(s):o>3?i(e,a,s):i(e,a))||s);return o>3&&s&&Object.defineProperty(e,a,s),s};const z=class{constructor(a){t(this,a),this.stateUpdate=e(this,"dyteStateUpdate",7),this.now=new Date,this.isContinued=!1,this.iconPack=s,this.t=d(),this.showBubble=!1,this.status="loading"}render(){return a(r,{key:"21e4840553f4bf78c44c2a5f62533987320bbbd1"},!this.isContinued&&a(l,{key:"34d84bdba01b9de19e4bb0f783155d23d109ecc5",name:this.message.displayName,time:this.message.time,now:this.now}),a("div",{key:"e411ad59933d4991482f52da5b6dc9d900ee2cde",class:{body:!0,bubble:this.showBubble},part:"body"},a("div",{key:"2c74e8d03c2a90326400cc7990286956fb7db33f",class:{image:!0,loaded:"loaded"===this.status}},a("img",{key:"33bd33d404ee97e41818b128f467df5b9c9557f4",src:p(this.message.link),onLoad:()=>{this.status="loaded"},onError:()=>{this.status="errored"},onClick:()=>{"loaded"===this.status&&(this.stateUpdate.emit({image:this.message}),c.image=this.message)}}),"loading"===this.status&&a("div",{key:"fc2059d3d2aefc89386bb879503015acbb93a2a3",class:"image-spinner",title:this.t("chat.img.loading"),"aria-label":this.t("chat.img.loading")},a("dyte-spinner",{key:"28b6ce41c69597b95047cbfa9da596c51cbc0492",iconPack:this.iconPack,t:this.t})),"errored"===this.status&&a("div",{key:"600b8e40635e8235d25e2ab633798f4acd716417",class:"image-errored",title:this.t("chat.error.img_not_found"),"aria-label":this.t("chat.error.img_not_found")},a("dyte-icon",{key:"6975ab96abedbe982b6db9ea307d6ab4f3e2076a",icon:this.iconPack.image_off,iconPack:this.iconPack,t:this.t})),"loaded"===this.status&&a("div",{key:"dc8e151d2c4436dbbeb0f7ac3eb71b3d79c4bbf3",class:"actions"},a("dyte-button",{key:"57ca5b10b37462321fe3bad1f3bad43ad52f98d3",class:"action",variant:"secondary",kind:"icon",onClick:()=>{this.stateUpdate.emit({image:this.message}),c.image=this.message},iconPack:this.iconPack,t:this.t},a("dyte-icon",{key:"9fa5a9ee53efdd7f80b4c1c95cabf4f194da506f",icon:this.iconPack.full_screen_maximize})),a("dyte-button",{key:"690867cb173ea7bb582417f2883690791c8103fb",class:"action",variant:"secondary",kind:"icon",onClick:()=>g(this.message.link,{fallbackName:"image"}),iconPack:this.iconPack,t:this.t},a("dyte-icon",{key:"10cec3132e3e2fd674371eb9f39b21203eaa34bc",icon:this.iconPack.download,iconPack:this.iconPack,t:this.t}))))))}};j([n()],z.prototype,"iconPack",void 0),j([n()],z.prototype,"t",void 0),z.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.image-spinner{cursor:wait}.image-errored{cursor:not-allowed}";var P=function(t,e,a,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,r);else for(var d=t.length-1;d>=0;d--)(i=t[d])&&(s=(o<3?i(s):o>3?i(e,a,s):i(e,a))||s);return o>3&&s&&Object.defineProperty(e,a,s),s};const C=class{constructor(e){t(this,e),this.autoScroll=!0,this.iconPack=s,this.t=d(),this.emptyListLabel=null,this.isLoading=!1,this.rerenderBoolean=!1,this.shouldRenderNewNodes=!0,this.hasNewNodesToRender=!1,this.showEmptyListLabel=!1,this.pagesToRender=[[]],this.currentTime=()=>(new Date).getTime(),this.observe=t=>{t&&this.intersectionObserver.observe(t)}}async onNewNode(t){this.shouldRenderNewNodes?(this.addNodeToRender(t,!1),this.rerender()):this.hasNewNodesToRender=!0}async onNodeDelete(t){const e=this.pagesToRender.flat().length;this.pagesToRender=this.pagesToRender.map((e=>e.filter((e=>e.id!==t)))),e!==this.pagesToRender.flat().length&&this.rerender()}async onNodeUpdate(t,e){let a=!1;this.pagesToRender=this.pagesToRender.map((r=>r.map((r=>r.id===t?(a=!0,e):r)))),a&&this.rerender()}onItemChanged(t,e){t!==e&&(this.pagesToRender=[[]],this.loadFirstPage().then((()=>this.rerender())))}connectedCallback(){this.rerender=f(this.rerender.bind(this),50,{maxWait:200}),this.intersectionObserver=new IntersectionObserver((t=>{o((()=>{for(const e of t)"bottom-scroll"===e.target.id&&(e.isIntersecting?this.loadBottom():this.shouldRenderNewNodes=!1),"top-scroll"===e.target.id&&e.isIntersecting&&this.loadTop()}))}))}disconnectedCallback(){this.intersectionObserver.disconnect()}componentDidLoad(){this.loadFirstPage(),this.observe(this.$topRef),this.observe(this.$bottomRef)}componentDidRender(){this.shouldRenderNewNodes&&this.autoScroll&&v(this.$paginatedList)}loadFirstPage(){return this.loadPage(this.currentTime(),this.pageSize,!0,(t=>{0===t.length&&(this.showEmptyListLabel=!0)}))}loadTop(){0!==this.pagesToRender.length&&(1===this.pagesToRender.length&&this.pagesToRender[0].length<this.pageSize||this.loadPage(this.pagesToRender[0][0].timeMs-1,this.pageSize,!0,(()=>{})))}loadBottom(){if(0===this.pagesToRender.length)return void(this.shouldRenderNewNodes=!0);if(1===this.pagesToRender.length&&this.pagesToRender[0].length<this.pageSize)return void(this.shouldRenderNewNodes=!0);const t=this.pagesToRender.at(-1).at(-1);this.loadPage(t.timeMs+1,this.pageSize,!1,(()=>v(this.$paginatedList)))}addNodeToRender(t,e){if(e){const e=this.pagesToRender[0];e&&(null==e?void 0:e.length)<this.pageSize?e.unshift(t):(this.pagesToRender.unshift([t]),this.removeLastPageIfNeeded(!1))}else{const[e]=this.pagesToRender.slice(-1);e&&(null==e?void 0:e.length)<this.pageSize?e.push(t):(this.pagesToRender.push([t]),this.removeLastPageIfNeeded(!0))}}async loadPage(t,e,a,r=(()=>{})){this.isLoading=!0;const i=await this.fetchData(t,e,a);if(this.isLoading=!1,!(null==i?void 0:i.length))return a||(this.hasNewNodesToRender=!1,this.shouldRenderNewNodes=!0),void r([]);i.forEach((t=>this.addNodeToRender(t,a))),this.rerender(),r(i)}rerender(){this.rerenderBoolean=!this.rerenderBoolean}removeLastPageIfNeeded(t){this.pagesToRender.length>this.pagesAllowed&&(t?this.pagesToRender.shift():this.pagesToRender.pop())}onDownArrowClicked(){this.loadBottom()}render(){var t;return a(r,{key:"704a4d2f1669f83d2b609276c4e43b7d242dc204"},a("div",{key:"a73818c8a9db30909b021e5409a05e54b917172c",class:"scrollbar container",part:"container",ref:t=>this.$paginatedList=t},a("div",{key:"4f3c5bbde0e1e3d868b9f188c1de0aea83c57ef7",class:{"show-new-messages-ctr":!0,active:!this.shouldRenderNewNodes}},a("dyte-button",{key:"a5299c188b7b40e178fa521f0906e9cc1c2cdebb",class:"show-new-messages",kind:"icon",variant:"secondary",part:"show-new-messages",onClick:()=>this.onDownArrowClicked(),iconPack:this.iconPack,t:this.t},a("dyte-icon",{key:"6154956812d95d1eb527f0c052144ce6aa86e97f",icon:this.iconPack.chevron_down,iconPack:this.iconPack,t:this.t}))),a("div",{key:"9487043b2c6e6dd228b1bcf6deeb985d8faf6e6c",class:"smallest-dom-element",id:"bottom-scroll",ref:t=>this.$bottomRef=t}),this.isLoading&&0===this.pagesToRender.flat().length&&a("dyte-spinner",{key:"fae6afec4d3099531bfabb6a589e3aceefd1dec6",size:"lg"}),0===this.pagesToRender.flat().length&&this.showEmptyListLabel?a("div",{class:"empty-list"},null!==(t=this.emptyListLabel)&&void 0!==t?t:this.t("list.empty")):a("div",{class:"page-wrapper"},this.pagesToRender.map((t=>this.createNodes(t)))),a("div",{key:"0d74b9c37c8c5f7fe09dd1986646197ca8ec7d2d",class:"smallest-dom-element",id:"top-scroll",ref:t=>this.$topRef=t})))}static get watchers(){return{selectedItemId:["onItemChanged"]}}};P([n()],C.prototype,"iconPack",void 0),P([n()],C.prototype,"t",void 0),C.style=".scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;flex:1}.container{box-sizing:border-box;display:flex;flex-direction:column-reverse;padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);flex:1 0 0px;overflow-y:scroll;}.file-picker{display:none}.chat *:first-child{margin-top:var(--dyte-space-0, 0px)}.chat .head{display:flex;align-items:center}.chat .head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.chat .head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat .body{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);overflow-wrap:break-word;font-size:14px;line-height:1.375}.chat .body .emoji{font-size:24px}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-text-message,dyte-image-message,dyte-file-message{margin-top:var(--dyte-space-4, 16px);display:block;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);font-family:var(--dyte-font-family, sans-serif);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}*[is-continued]{margin-top:var(--dyte-space-3, 12px)}dyte-text-message[is-continued]{margin-top:var(--dyte-space-2, 8px)}.chat .image{position:relative;height:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);cursor:pointer}.chat .image img{display:none;height:100%;width:100%;border-radius:var(--dyte-border-radius-sm, 4px);-o-object-fit:cover;object-fit:cover}.chat .image .image-spinner{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.chat .image .image-spinner dyte-spinner{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.chat .image .image-errored{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.1);--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.chat .image .actions{display:none;height:var(--dyte-space-8, 32px);align-items:center;position:absolute;top:var(--dyte-space-2, 8px);right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.chat .image .actions .action{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:var(--dyte-border-radius-none, 0);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.chat .image .actions .action:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.image.loaded img{display:block}.image.loaded .image-spinner{display:none}.image:hover .actions,.image:focus .actions{display:flex}.chat .file{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1\\.5, 6px);padding-bottom:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.chat .file .file-data{flex:1 1 0%}.chat .file .file-data .name{word-break:break-all;color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.chat .file .file-data .file-data-split{margin-top:var(--dyte-space-0\\.5, 2px);display:flex;align-items:center;font-size:12px}.chat .file .file-data .file-data-split .ext{margin-right:var(--dyte-space-2, 8px);text-transform:uppercase;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.chat .file .file-data .file-data-split .divider{height:var(--dyte-space-4, 16px);width:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.chat .file .file-data .file-data-split .size{margin-left:var(--dyte-space-2, 8px)}.smallest-dom-element{width:1px}#top-scroll{transform:translateY(20vh)}#bottom-scroll{transform:translateY(-20vh)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));text-decoration-line:none}a:hover{text-decoration-line:underline}.show-new-messages-ctr{pointer-events:none;position:absolute;bottom:var(--dyte-space-2, 8px);right:var(--dyte-space-4, 16px);z-index:10;margin-top:calc(var(--dyte-space-14, 56px) * -1);--tw-translate-y:var(--dyte-space-28, 112px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages-ctr.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}.show-new-messages{pointer-events:auto;border-radius:9999px}.show-new-messages:hover{border-radius:9999px;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);--tw-ring-opacity:1;--tw-ring-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-ring-opacity));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}dyte-spinner,.empty-list{margin:auto}.page-wrapper{margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px)}.message-wrapper{margin-bottom:var(--dyte-space-2, 8px)}.pinned .message-wrapper{position:relative}.pinned .pin-icon{position:absolute;right:calc(var(--dyte-space-1, 4px) * -1);top:calc(var(--dyte-space-1, 4px) * -1);display:flex;border-radius:var(--dyte-border-radius-sm, 4px)}.pinned dyte-message-view{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px)}";var R=function(t,e,a,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,r);else for(var d=t.length-1;d>=0;d--)(i=t[d])&&(s=(o<3?i(s):o>3?i(e,a,s):i(e,a))||s);return o>3&&s&&Object.defineProperty(e,a,s),s};const _=class{constructor(e){t(this,e),this.now=new Date,this.isContinued=!1,this.iconPack=s,this.t=d(),this.showBubble=!1}render(){return a(r,{key:"f97ee3d64fc809d8f985e3ebdebdd167d6743f3f"},!this.isContinued&&a(l,{key:"e67cd5280cbb73f69daaddabaa48de6735f95828",name:this.message.displayName,time:this.message.time,now:this.now}),a("div",{key:"ec8b235b91c49ea567932e76c04541726f29d27a",class:{body:!0,bubble:this.showBubble},part:"body"},a("div",{key:"7a08a0bae7adee1cab2590e26da13641d0a5fdf3",class:{text:!0,emoji:h(this.message.message)}},a(m,{key:"47a59e59e6410f8333f560fd93d18e03b94e5310",message:this.message.message}))))}};R([n()],_.prototype,"iconPack",void 0),R([n()],_.prototype,"t",void 0);export{x as dyte_chat_message,k as dyte_file_message,z as dyte_image_message,C as dyte_paginated_list,_ as dyte_text_message}