import{r as t,c as e,w as r,f as a,h as i,H as s,a as o}from"./p-aff91b47.js";import{b as n,d,s as c}from"./p-c8aa84cb.js";import"./p-e497ad6d.js";import{S as p}from"./p-dc76c799.js";var l=function(t,e,r,a){var i,s=arguments.length,o=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,a);else for(var n=t.length-1;n>=0;n--)(i=t[n])&&(o=(s<3?i(o):s>3?i(e,r,o):i(e,r))||o);return s>3&&o&&Object.defineProperty(e,r,o),o};const h=class{constructor(s){t(this,s),this.stateUpdate=e(this,"dyteStateUpdate",7),this.switchChannel=e(this,"switchChannel",7),this.t=n(),this.iconPack=d,this.channelName="",this.searchQuery="",this.step=1,this.loading=!1,this.selectedMemberIds=new Set,this.focusedMemberIndex=-1,this.showAllMembersList=!1,this.allMembers=new Map,this.inputTextRef=null,this.searchInputTextRef=null,this.focusOnSearch=(t=!1)=>{this.focusedMemberIndex=-1,r((()=>{var e,r;null===(e=this.searchInputTextRef)||void 0===e||e.focus(),t&&(null===(r=this.searchInputTextRef)||void 0===r||r.select())}))},this.onClickHandler=async()=>{if(0!==this.channelName.length){if(1===this.step){const t=this.meeting.participants.all.toArray(),e=this.meeting.self.userId;return t.filter((t=>t.userId!==e)).forEach((t=>this.allMembers.set(t.userId,t))),this.step=2,void this.focusOnSearch()}await this.createChannel()}},this.createChannel=async()=>{const t=Array.from(this.selectedMemberIds),e=await this.meeting.chat.createChannel(this.channelName,t,{displayPictureUrl:"",visibility:"public",isDirectMessage:!1});this.switchChannel.emit(e.id),this.stateUpdate.emit({activeChannelCreator:!1}),c.activeChannelCreator=!1},this.onMemberAdd=t=>{this.showAllMembersList=!1,this.selectedMemberIds.add(t),this.searchQuery="",this.focusOnSearch()},this.keyDownHandler=(t,e)=>{if("ArrowDown"===t.key)this.focusedMemberIndex=Math.min(this.focusedMemberIndex+1,e.length-1);else if("ArrowUp"===t.key){if(-1===this.focusedMemberIndex)return;if(0===this.focusedMemberIndex)return void this.focusOnSearch(!0);this.focusedMemberIndex=Math.max(this.focusedMemberIndex-1,0)}else if("Enter"===t.key)this.onMemberAdd(e[this.focusedMemberIndex].userId);else if("Backspace"===t.key){if(0!==this.searchQuery.length)return;if(0===this.selectedMemberIds.size)return;const t=Array.from(this.selectedMemberIds.values()).at(-1);this.selectedMemberIds.delete(t),a(this.$el)}},this.renderMemberSelector=()=>{const t=Array.from(this.allMembers.values()).filter((t=>!this.selectedMemberIds.has(t.userId)&&t.name.toLowerCase().includes(this.searchQuery.toLowerCase()))),e=Array.from(this.selectedMemberIds.values()).map((t=>this.allMembers.get(t))),s=this.selectedMemberIds.size===this.allMembers.size;return i("div",{class:"input-container"},i("ul",{class:"members scrollbar",onClick:()=>{var t;null===(t=this.searchInputTextRef)||void 0===t||t.focus()}},e.map((t=>i("li",{class:"pill"},i("dyte-avatar",{participant:{name:t.name,picture:t.picture},size:"sm"}),i("span",null,t.name),i("dyte-icon",{icon:this.iconPack.dismiss,onClick:()=>{this.selectedMemberIds.delete(t.userId),a(this.$el),this.focusOnSearch()}})))),!s&&i("input",{type:"text",ref:t=>this.searchInputTextRef=t,value:this.searchQuery,placeholder:0===this.selectedMemberIds.size?this.t("chat.member_name"):"",class:{"wide-input":0===this.selectedMemberIds.size},onInput:t=>{this.searchQuery=t.target.value.trim()},onClick:()=>{this.showAllMembersList=!this.showAllMembersList},onKeyDown:e=>this.keyDownHandler(e,t)})),(0!==this.searchQuery.length||this.showAllMembersList)&&i("ul",{class:"search-results"},t.map(((t,e)=>i("li",{class:{member:!0,selected:e===this.focusedMemberIndex},onClick:()=>this.onMemberAdd(t.userId),ref:t=>{e===this.focusedMemberIndex&&r((()=>{t&&t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}))}},i("dyte-avatar",{participant:{name:t.name,picture:t.picture},size:"sm"}),i("span",null,t.name)))),0===t.length&&i("li",{class:"member"},i("span",null,this.t("chat.error.empty_results")))))}}componentDidLoad(){var t;null===(t=this.inputTextRef)||void 0===t||t.focus()}render(){return i(s,{key:"08d04ef24d85d5618615dc63ece40b4a1570c0ab"},i("header",{key:"2e6add8db457652fb8c58d8c53dd3035efa845d4"},this.t(1===this.step?"chat.new_channel":"chat.add_members")),1===this.step&&i("input",{key:"9b8712ccf2c233fdbe8f622aa86343827f4928ba",class:"channel-name-input",type:"text",placeholder:this.t("chat.channel_name"),ref:t=>this.inputTextRef=t,onInput:t=>{this.channelName=t.target.value.trim()}}),2===this.step&&this.renderMemberSelector(),i("footer",{key:"3faae4d87aae60779ac582e808130025d8249ec1"},i("dyte-button",{key:"d8f2e4625f4c6bbad893e2c602e597847a3fa927",kind:"button",size:"lg",disabled:0===this.channelName.length,onClick:this.onClickHandler},this.t(1===this.step?"chat.add_members":"create"))))}get $el(){return o(this)}};l([p()],h.prototype,"meeting",void 0),l([p()],h.prototype,"t",void 0),l([p()],h.prototype,"iconPack",void 0),h.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));display:flex;flex-direction:column;width:var(--dyte-space-96, 384px);padding-left:var(--dyte-space-9, 36px);padding-right:var(--dyte-space-9, 36px);padding-top:var(--dyte-space-10, 40px);padding-bottom:var(--dyte-space-10, 40px)}header{margin-bottom:var(--dyte-space-8, 32px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px);font-size:24px;font-weight:600}.channel-name-input{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-3, 12px);font-size:16px;-webkit-appearance:none;-moz-appearance:none;appearance:none;line-height:1.25;outline:2px solid transparent;outline-offset:2px}.channel-name-input:focus{outline-width:2px;outline-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}footer{margin-top:var(--dyte-space-5, 20px);display:flex;justify-content:flex-end}.member{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding:var(--dyte-space-2, 8px)}.member dyte-avatar{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.input-container{position:relative;-webkit-appearance:none;-moz-appearance:none;appearance:none;line-height:1.25;outline:2px solid transparent;outline-offset:2px;outline-width:2px;outline-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5);border-radius:var(--dyte-border-radius-sm, 4px)}.input-container .members{margin:var(--dyte-space-0, 0px);max-height:var(--dyte-space-28, 112px);border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);list-style-type:none;display:flex;flex-wrap:wrap;gap:var(--dyte-space-1, 4px);cursor:text;font-size:16px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));overflow-y:auto;min-height:var(--dyte-space-7, 28px)}.input-container .pill{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.input-container .pill dyte-avatar{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.input-container .pill span{max-width:var(--dyte-space-32, 128px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.input-container .pill dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);cursor:pointer}.input-container input{width:var(--dyte-space-24, 96px);border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-1, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));outline:2px solid transparent;outline-offset:2px;font-size:16px;line-height:1.25rem}.input-container input.wide-input{width:100%}.search-results{margin:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-1, 4px);max-height:var(--dyte-space-28, 112px);width:100%;padding:var(--dyte-space-0, 0px);position:absolute;list-style-type:none;overflow-y:auto;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-md, 8px);--tw-border-spacing-x:var(--dyte-space-2, 8px);--tw-border-spacing-y:var(--dyte-space-2, 8px);border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-style:solid;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.search-results .member{cursor:pointer}.search-results .member dyte-avatar{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.search-results .member:hover,.search-results .member.selected{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-700, 2 70 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}";export{h as dyte_channel_creator}