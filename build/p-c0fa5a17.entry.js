import{r as t,c as i,h as s,H as e,a}from"./p-aff91b47.js";import{d as h,u as c,F as n,s as d}from"./p-9362c375.js";import{l as o,R as l}from"./p-fd4b6d8b.js";import{f as r,s as f}from"./p-338c7261.js";import{d as p}from"./p-5a97005d.js";import"./p-e497ad6d.js";import{c as b,a as y,o as v,s as m,h as u}from"./p-4ebfbb95.js";import{S as g}from"./p-2fbb888d.js";var k=function(t,i,s,e){var a,h=arguments.length,c=h<3?i:null===e?e=Object.getOwnPropertyDescriptor(i,s):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,i,s,e);else for(var n=t.length-1;n>=0;n--)(a=t[n])&&(c=(h<3?a(c):h>3?a(i,s,c):a(i,s))||c);return h>3&&c&&Object.defineProperty(i,s,c),c};const x=class{constructor(s){t(this,s),this.dyteSendNotification=i(this,"dyteSendNotification",7),this.pinnedListener=({isPinned:t})=>{this.isPinned=t},this.toggleTileListener=({hidden:t})=>{this.isHidden=t},this.stageListener=({stageStatus:t})=>{this.isOnStage="ON_STAGE"===t},this.view="sidebar",this.iconPack=h,this.t=c(),this.config=p,this.audioEnabled=!1,this.videoEnabled=!1,this.isPinned=!1,this.isHidden=!1,this.isOnStage=!1,this.canDisableParticipantAudio=!1,this.canDisableParticipantVideo=!1,this.canKickParticipant=!1,this.canPinParticipant=!1,this.canAllowParticipantOnStage=!1,this.menuOpen=!1,this.permissionsUpdateListener=()=>{this.meetingChanged(this.meeting)},this.inviteToStageToggle=async()=>{const t=this.participant,{stage:i}=this.meeting;"ACCEPTED_TO_JOIN_STAGE"!==t.stageStatus?(this.isOnStage?(t.isPinned&&t.unpin(),await i.kick([t.userId])):(await i.grantAccess([t.userId]),this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-invite-${t.id}`})),this.isOnStage="ON_STAGE"===t.stageStatus):this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-${t.id}`})},this.handleOutsideClick=t=>{!t.composedPath().includes(this.host)&&this.menuOpen&&(this.menuOpen=!1)},this.update=()=>{const t=this.host.shadowRoot.getElementById("trigger"),i=this.host.shadowRoot.getElementById("menu-list");b(t,i,{placement:"bottom-end",middleware:[y({allowedPlacements:["bottom-end","top-end"],alignment:"end"}),v(4),m({padding:8}),u()]}).then((({x:t,y:s,placement:e})=>{let a=null;a="bottom-end"===e?{right:`${t}px`,top:`${s}px`}:{right:`${t}px`,bottom:`${s}px`},Object.assign(i.style,a)}))},this.onMenuToggle=()=>{this.menuOpen=!this.menuOpen,this.menuOpen&&this.update()}}connectedCallback(){this.meetingChanged(this.meeting),this.participantChanged(this.participant),document.addEventListener("click",this.handleOutsideClick)}disconnectedCallback(){var t;document.removeEventListener("click",this.handleOutsideClick),null===(t=this.meeting)||void 0===t||t.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener),null!=this.participant&&null!=this.participant.removeListener&&(this.audioUpdateListener&&this.participant.removeListener("audioUpdate",this.audioUpdateListener),this.videoUpdateListener&&this.participant.removeListener("videoUpdate",this.videoUpdateListener),this.participant.removeListener("pinned",this.pinnedListener),this.participant.removeListener("unpinned",this.pinnedListener),this.participant.removeListener("stageStatusUpdate",this.stageListener),this.participant.removeListener("toggleTile",this.toggleTileListener))}meetingChanged(t){var i,s,e,a,h,c,d;if(null!=t){const{self:o}=t;this.canDisableParticipantAudio=o.permissions.canAllowParticipantAudio||o.permissions.canDisableParticipantAudio,this.canDisableParticipantVideo=o.permissions.canAllowParticipantVideo||o.permissions.canDisableParticipantVideo,this.canKickParticipant=o.permissions.kickParticipant&&!0!==(null===(i=this.meeting)||void 0===i?void 0:i.__internals__.features.hasFeature(n.DISABLE_KICKING))&&(!0!==(null===(s=this.meeting)||void 0===s?void 0:s.__internals__.features.hasFeature(n.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(e=this.participant)||void 0===e?void 0:e.presetName)),this.canPinParticipant=o.permissions.pinParticipant,this.canAllowParticipantOnStage=o.permissions.acceptStageRequests&&o.permissions.stageEnabled&&(!0!==(null===(a=this.meeting)||void 0===a?void 0:a.__internals__.features.hasFeature(n.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(h=this.participant)||void 0===h?void 0:h.presetName))&&(!0!==(null===(c=this.meeting)||void 0===c?void 0:c.__internals__.features.hasFeature(n.CANTINVITE_VIEWER))||"webinar_viewer"!==(null===(d=this.participant)||void 0===d?void 0:d.presetName)),t.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)}}participantChanged(t){var i;if(null!=t){if(this.audioEnabled=t.audioEnabled,this.videoEnabled=t.videoEnabled,this.isPinned=t.isPinned,this.isHidden=null!==(i=t.hidden)&&void 0!==i&&i,this.isOnStage="ON_STAGE"===t.stageStatus,this.audioUpdateListener=({audioEnabled:t})=>{this.audioEnabled=t},this.videoUpdateListener=({videoEnabled:t})=>{this.videoEnabled=t},null==t.addListener)return;t.addListener("audioUpdate",this.audioUpdateListener),t.addListener("videoUpdate",this.videoUpdateListener),t.addListener("pinned",this.pinnedListener),t.addListener("unpinned",this.pinnedListener),t.addListener("stageStatusUpdate",this.stageListener),this.participant.addListener("toggleTile",this.toggleTileListener)}}render(){var t,i,a,h,c,n,p,b,y;const v="AUDIO_ROOM"===(null===(t=this.meeting)||void 0===t?void 0:t.meta.viewType),m=(null===(i=this.meeting)||void 0===i?void 0:i.self.id)===this.participant.id,u=this.canDisableParticipantAudio&&this.audioEnabled||this.canDisableParticipantVideo&&this.videoEnabled&&!v||this.canKickParticipant||this.canPinParticipant&&this.isOnStage||this.canAllowParticipantOnStage,g=r((null===(a=this.participant)||void 0===a?void 0:a.name)||""),k=this.isOnStage||["GROUP_CALL","AUDIO_ROOM"].includes(null===(h=this.meeting)||void 0===h?void 0:h.meta.viewType),x={meeting:this.meeting,size:"sm",states:d,config:this.config,iconPack:this.iconPack,t:this.t};return s(e,{key:"1fa766d2be97ec19e57b8f92bf44103f0ecc5c71"},s("div",{class:"left",key:null===(c=this.participant)||void 0===c?void 0:c.id},s("dyte-avatar",{key:"5becacba019dbe9f988e742e30cb477cf07c6816",participant:this.participant,size:"sm",iconPack:this.iconPack,t:this.t}),s("p",{key:"f96102e70cc238920f30328c900a130d5f0e5652",class:"name",title:g},f(g,16)," ",(null===(n=this.meeting)||void 0===n?void 0:n.self.id)===(null===(p=this.participant)||void 0===p?void 0:p.id)&&this.t("(you)"))),"sidebar"===this.view&&s("div",{key:"df59f385d405bfb0e53e6d68a4679885c4a80a0a",class:"right"},k&&s("dyte-icon",{key:"0282c564f78515606dfa9e86081362a83b9b42c2",class:{red:!this.audioEnabled},iconPack:this.iconPack,t:this.t,icon:this.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off}),k&&!v&&s("dyte-icon",{key:"c20d87702a2e45eb3d11b24d066c828e6f85d49e",class:{red:!this.videoEnabled},iconPack:this.iconPack,t:this.t,icon:this.videoEnabled?this.iconPack.video_on:this.iconPack.video_off}),(u||o({element:"dyte-participant",defaults:x,childProps:{participant:this.participant}})>0)&&s("div",{key:"c4782b159f2868cce1329336d4ec0c5fa9ce927b",class:"menu"},s("span",{key:"59f34b5c5c3613a2c142db5517d1a6f4af523d63",id:"trigger",onClick:this.onMenuToggle},s("dyte-button",{key:"f5fa1ce51a78a3395d6d8b2fd1eb9e94cc79891e",variant:"ghost",kind:"icon",slot:"trigger",iconPack:this.iconPack,t:this.t},s("dyte-icon",{key:"5f39bcb35ff1814e2899e39bbb172fc909cb1599",class:"more",icon:this.iconPack.more_vertical}))),s("span",{key:"63f398f86875c5785dc5389f089edd7b85737027",id:"menu-list"},this.menuOpen&&s("dyte-menu-list",{key:"38db1f5ff935e39e2d57f4eccc41d9a082a9b4a1",iconPack:this.iconPack,t:this.t},this.canPinParticipant&&k&&!v&&s("dyte-menu-item",{key:"fb8afb7f614e9f330581367ffa508cc98cf7d56a",onClick:()=>{this.isPinned?this.participant.unpin():this.participant.pin()},iconPack:this.iconPack,t:this.t},s("dyte-icon",{key:"7c886b4b76a53074635401c2340dc527b2405b5c",icon:this.isPinned?this.iconPack.pin_off:this.iconPack.pin,slot:"start",iconPack:this.iconPack,t:this.t}),this.t(this.isPinned?"unpin":"pin")),m&&s("dyte-menu-item",{key:"0bf508a6022fe25c2298df68ad87a3bc76c02f10",iconPack:this.iconPack,t:this.t,onClick:()=>{this.isHidden?this.participant.show():this.participant.hide()}},s("dyte-icon",{key:"0e8e3979d4bc3d9a8734ced7fc2f1742ba13a2b3",icon:this.isHidden?this.iconPack.minimize:this.iconPack.maximize,slot:"start"}),this.t(this.meeting.self.hidden?"maximize":"minimize")),this.canDisableParticipantAudio&&k&&this.audioEnabled&&s("dyte-menu-item",{key:"596b17dcce8779b09e2ff417b35ce7fe2c184d70",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableAudio()}},s("dyte-icon",{key:"53f732cf50b72c495fe1eeae2b15f09164348861",icon:this.iconPack.mic_off,slot:"start"}),this.t("mute")),this.canDisableParticipantVideo&&k&&this.videoEnabled&&s("dyte-menu-item",{key:"05b1533596f25a8f88c4e9ba314e9dda8f6de70c",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableVideo()}},s("dyte-icon",{key:"98c047da577208aa36e549ba6bb7d2b82819909e",icon:this.iconPack.video_off,slot:"start",iconPack:this.iconPack,t:this.t}),this.t("participants.turn_off_video")),this.canAllowParticipantOnStage&&(null===(b=this.participant)||void 0===b?void 0:b.id)!==(null===(y=this.meeting)||void 0===y?void 0:y.self.id)&&s("dyte-menu-item",{key:"e979d659610a5f992db11be696086a9e7a8a0e15",iconPack:this.iconPack,t:this.t,class:this.isOnStage?"red":"",onClick:this.inviteToStageToggle},s("dyte-icon",{key:"69e979781f9272daf85a33760636ee9d4ff9510e",iconPack:this.iconPack,t:this.t,icon:this.isOnStage?this.iconPack.leave_stage:this.iconPack.join_stage,slot:"start"}),this.t(this.isOnStage?"stage.remove_from_stage":"stage.add_to_stage")),!m&&this.canKickParticipant&&s("dyte-menu-item",{key:"48c96ebabafc822467fc42a3502d9a9c783c35aa",iconPack:this.iconPack,t:this.t,class:"red",onClick:()=>{var t,i;null===(t=this.meeting)||void 0===t||t.participants.kick(null===(i=this.participant)||void 0===i?void 0:i.id)}},s("dyte-icon",{key:"f655aa2a703ab04ca66d1613151f65572784fccf",icon:this.iconPack.dismiss,slot:"start",iconPack:this.iconPack,t:this.t}),this.t("kick")),s("slot",{key:"3e3c8151e5e736a6c2184b00d699ff50bd60f8b6"},s(l,{key:"458ec644bc0732cb12c0d6358b933f37bc1dcf14",element:"dyte-participant",defaults:x,childProps:{participant:this.participant},deepProps:!0,onlyChildren:!0})))))))}get host(){return a(this)}static get watchers(){return{meeting:["meetingChanged"],participant:["participantChanged"]}}};k([g()],x.prototype,"meeting",void 0),k([g()],x.prototype,"iconPack",void 0),k([g()],x.prototype,"t",void 0),x.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;height:var(--dyte-space-14, 56px);align-items:center;justify-content:space-between;cursor:pointer;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}:host dyte-avatar{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);font-size:14px}.left{display:flex;align-items:center}.left>*{margin-right:var(--dyte-space-2, 8px)}.left>*:last-child{margin-right:var(--dyte-space-0, 0px)}.right{display:flex;align-items:center;justify-content:flex-end}.right>*{margin-left:var(--dyte-space-2, 8px)}.right>*:first-child{margin-left:var(--dyte-space-0, 0px)}.name{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}dyte-icon.red{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon.more{cursor:pointer}.menu{position:relative;display:inline-block;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}#menu-list{position:absolute;top:var(--dyte-space-8, 32px) !important;right:var(--dyte-space-4, 16px) !important;z-index:20}";export{x as dyte_participant}