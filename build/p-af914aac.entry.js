import{r as t,h as i,a as s}from"./p-69f2ebde.js";import{d as h}from"./p-36ba48a7.js";import"./p-63092db3.js";const e=class{constructor(i){t(this,i),this.containerHeight=0,this.lastScrollTop=0,this.recalculatePositioning=()=>{this.updateContainerHeight(),requestAnimationFrame((()=>{this.updateItemHeight()}))},this.updateContainerHeight=()=>{this.el.querySelector(".virtual-list-container").clientHeight&&(requestAnimationFrame((()=>{this.updateItemHeight()})),this.containerHeight=this.el.querySelector(".virtual-list-container").clientHeight,this.updateVisibleRange())},this.onScroll=h((()=>{const t=this.el.querySelector(".virtual-list-container").scrollTop;t>this.lastScrollTop&&this.visibleEnd===this.items.length||(this.lastScrollTop=t,this.updateVisibleRange())})),this.items=[],this.renderItem=void 0,this.itemHeight=55,this.bufferedItemsCount=5,this.emptyListElement=null,this.visibleStart=0,this.visibleEnd=0}itemsChanged(){this.recalculatePositioning()}componentDidLoad(){this.recalculatePositioning(),this.el.querySelector(".virtual-list-container").addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.recalculatePositioning)}componentDidUpdate(){this.updateItemHeight()}disconnectedCallback(){this.el.querySelector(".virtual-list-container").removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.recalculatePositioning)}updateVisibleRange(){const t=this.el.querySelector(".virtual-list-container").scrollTop,i=Math.floor(t/this.itemHeight),s=Math.ceil(this.containerHeight/this.itemHeight),h=Math.min(this.items.length,i+s+this.bufferedItemsCount);this.visibleStart=i,this.visibleEnd=h,this.el.querySelector(".virtual-list-container").scrollTop=this.lastScrollTop}updateItemHeight(){const t=this.el.querySelector(".virtual-list-item");if(t){const i=t.style.height;t.style.height="auto";const s=t.getBoundingClientRect().height;i&&(t.style.height=i),s&&Math.floor(s)!==Math.floor(this.itemHeight)&&(this.itemHeight=s)}}renderItems(){return this.items.slice(this.visibleStart,this.visibleEnd).map(((t,s)=>{const h=this.visibleStart+s;return i("div",{class:"virtual-list-item",key:t.id,style:{position:"absolute",top:h*this.itemHeight+"px",height:`${this.itemHeight}px`,width:"100%"}},this.renderItem(t,h))}))}render(){var t;return i("div",{class:"virtual-list-container",style:{position:"relative",height:"100%",overflowX:"hidden",overflowY:"auto"}},i("div",{style:{height:this.items.length*this.itemHeight+"px",position:"relative"}},(null===(t=this.items)||void 0===t?void 0:t.length)?this.renderItems():this.emptyListElement),i("div",{style:{height:`${this.itemHeight}px`}}))}get el(){return s(this)}static get watchers(){return{items:["itemsChanged"]}}};e.style=":host{height:100%;width:100%}";export{e as dyte_virtualized_participant_list}