import{r as t,h as e,H as i,c as a}from"./p-69f2ebde.js";import"./p-1210aa77.js";import"./p-26e8d50e.js";import{s as r,P as s}from"./p-799d72ea.js";import{d as o}from"./p-cadf534b.js";import{u as n}from"./p-54de5543.js";import"./p-57e22a58.js";import"./p-aafa2ac8.js";import"./p-19c79157.js";const d=class{constructor(e){t(this,e),this.setIsLivestreaming=t=>{this.isLivestreaming="LIVESTREAMING"===t},this.meeting=void 0,this.size=void 0,this.t=n(),this.isLivestreaming=void 0,this.iconPack=o}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var t,e;null===(e=null===(t=this.meeting)||void 0===t?void 0:t.livestream)||void 0===e||e.removeListener("livestreamUpdate",this.setIsLivestreaming)}meetingChanged(t){var e,i;null!=t&&(this.setIsLivestreaming(null===(e=this.meeting.livestream)||void 0===e?void 0:e.state),null===(i=this.meeting.livestream)||void 0===i||i.on("livestreamUpdate",this.setIsLivestreaming))}render(){if(r(this.meeting)&&this.isLivestreaming)return e(i,null,e("div",{class:"indicator","aria-label":this.t("livestream.indicator"),part:"indicator"},e("dyte-icon",{icon:this.iconPack.start_livestream,size:this.size}),e("span",null,this.t("LIVE"))))}static get watchers(){return{meeting:["meetingChanged"]}}};d.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:flex}:host[size='sm']{margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px)}.indicator{display:flex;flex-direction:row;align-items:center;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);animation:blink 4s linear infinite}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([size='sm']) .indicator span{display:none}@keyframes blink{0%,10%{opacity:0}11%,100%{opacity:1}}";const p=class{constructor(e){t(this,e),this.dyteAPIError=a(this,"dyteAPIError",7),this.livestreamUpdateListener=t=>{this.livestreamState=t},this.getLoadingState=()=>{let t="",e=!1,i=!1;switch(this.livestreamState){case"IDLE":t=this.t("livestream.idle"),e=!0,i=!1;break;case"STARTING":t=this.t("livestream.starting"),e=!0,i=!0;break;case"STOPPING":t=this.t("livestream.stopping"),e=!0,i=!0;break;case"LIVESTREAMING":this.playerState!==s.PLAYING&&(t=this.t("livestream.starting"),i=!0,e=!0);break;default:e=!1,t=this.t(""),i=!0}return{isLoading:e,loadingMessage:t,showIcon:i}},this.getErrorState=()=>{var t,e;let i=!1,a="";return"LIVESTREAMING"!==this.livestreamState?(i=!1,a=this.t(""),{isError:i,errorMessage:a}):(this.isSupported||(i=!0,a=this.t("livestream.error.not_supported")),this.playbackUrl||(i=!0,a=this.t("livestream.error.not_found")),this.playerError&&(i=!0,a=this.t(null!==(e=null===(t=this.playerError)||void 0===t?void 0:t.message)&&void 0!==e?e:"livestream.error.unknown")),{isError:i,errorMessage:a})},this.meeting=void 0,this.size=void 0,this.t=n(),this.iconPack=o,this.playbackUrl=void 0,this.isSupported=!0,this.playerState=s.IDLE,this.livestreamState="IDLE",this.playerError=void 0,this.latency=0,this.audioPlaybackError=!1}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting.livestream.removeListener("livestreamUpdate",this.livestreamUpdateListener),this.player=void 0}meetingChanged(t){null!=t&&(this.livestreamState=this.meeting.livestream.state,this.meeting.livestream.on("livestreamUpdate",this.livestreamUpdateListener))}render(){if(!r(this.meeting))return;const{isError:t,errorMessage:a}=this.getErrorState(),{isLoading:s,loadingMessage:o,showIcon:n}=this.getLoadingState();return e(i,null,e("div",{class:"player-container"},"LIVESTREAMING"===this.livestreamState?e("iframe",{src:this.meeting.livestream.playbackUrl.replace("/manifest/video.m3u8","/iframe?autoplay=true"),allowFullScreen:!0,allowTransparency:!0,allow:"accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;",class:"player z-10"}):null,this.audioPlaybackError&&e("div",{class:"unmute-popup"},e("h3",null,this.t("audio_playback.title")),e("p",null,this.t("audio_playback.description")),e("dyte-button",{kind:"wide",onClick:()=>{this.player.muted=!1,this.audioPlaybackError=!1},title:this.t("audio_playback"),iconPack:this.iconPack,t:this.t},this.t("audio_playback"))),t&&e("div",{class:"loader"},e("dyte-icon",{icon:this.iconPack.warning,t:this.t}),e("p",null,a)),!t&&s&&e("div",{class:"loader"},n&&e("dyte-spinner",{id:"icon",part:"spinner",iconPack:this.iconPack,t:this.t,size:"md"}),e("p",null,o))))}static get watchers(){return{meeting:["meetingChanged"]}}};p.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:flex;height:100%;width:100%;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.player-container{position:relative;margin:var(--dyte-space-4, 16px);display:flex;flex-grow:1;align-items:center;justify-content:center;overflow:hidden;border-radius:var(--dyte-border-radius-md, 8px)}.player{left:var(--dyte-space-0, 0px);z-index:20;aspect-ratio:16 / 9;height:100%;width:auto;border-radius:var(--dyte-border-radius-md, 8px);border-width:0px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.loader{position:absolute;z-index:10;height:100%;width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));display:flex;flex-direction:column;align-items:center;justify-content:center}p{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);font-size:16px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.latency-controls{position:absolute;bottom:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);z-index:20;display:flex;flex-direction:row;align-items:center}.sync-live-stream{cursor:pointer;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);font-size:12px}.unmute-popup{position:absolute;z-index:30 !important;display:flex;width:var(--dyte-space-72, 288px);flex-direction:column;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding:var(--dyte-space-4, 16px);text-align:center;max-width:70%}.unmute-popup h3{margin:var(--dyte-space-0, 0px);font-size:16px;font-weight:500}.unmute-popup p{margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px);font-size:14px}";const c=class{constructor(e){t(this,e),this.disconnectMeeting=t=>{var e;null!=t&&null!=this.countListener&&(null===(e=t.livestream)||void 0===e||e.removeListener("viewerCountUpdate",this.countListener))},this.meeting=void 0,this.variant="primary",this.iconPack=o,this.t=n(),this.viewerCount=0}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(t,e){var i;this.disconnectMeeting(e),null!=t&&(this.countListener=()=>{var e;this.viewerCount=null===(e=t.livestream)||void 0===e?void 0:e.viewerCount},this.countListener(),null===(i=t.livestream)||void 0===i||i.addListener("viewerCountUpdate",this.countListener))}render(){return r(this.meeting)?e(i,{tabIndex:0,role:"log","aria-label":`${this.viewerCount} ${this.t("viewers")}`},e("dyte-icon",{icon:this.iconPack.viewers,tabIndex:-1,"aria-hidden":!0,part:"icon",iconPack:this.iconPack,t:this.t}),this.viewerCount," ",this.t("viewers")):null}static get watchers(){return{meeting:["meetingChanged"]}}};c.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:inline-flex;height:var(--dyte-space-10, 40px);-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;font-size:14px}:host([size='sm']){margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px);font-size:12px}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([variant='embedded']){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));opacity:0.5;margin-top:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);border-radius:var(--dyte-border-radius-sm, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);font-size:12px}:host([variant='embedded']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}";export{d as dyte_livestream_indicator,p as dyte_livestream_player,c as dyte_viewer_count}