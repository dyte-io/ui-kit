import{r as t,c as s,h as i,H as e}from"./p-69f2ebde.js";import{d as a}from"./p-7fae8517.js";import{u as r}from"./p-2076e7ec.js";import{i as h}from"./p-d8de34da.js";import{s as n}from"./p-1210aa77.js";import"./p-57e22a58.js";const o=class{constructor(i){t(this,i),this.stateUpdate=s(this,"dyteStateUpdate",7),this.dyteAPIError=s(this,"dyteAPIError",7),this.livestreamStateListener=t=>{this.livestreamState=t,"LIVESTREAMING"!==t&&"IDLE"!==t||(this.stateUpdate.emit({activeMoreMenu:!1}),n.activeMoreMenu=!1)},this.isLoading=()=>null==this.meeting||"STARTING"===this.livestreamState||"STOPPING"===this.livestreamState,this.variant="button",this.meeting=void 0,this.size=void 0,this.iconPack=a,this.t=r(),this.livestreamState="IDLE"}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.clearListeners()}meetingChanged(t){var s,i;null!=t&&(this.livestreamState=null===(s=this.meeting.livestream)||void 0===s?void 0:s.state,null===(i=this.meeting.livestream)||void 0===i||i.on("livestreamUpdate",this.livestreamStateListener))}async toggleLivestream(){var t,s;if("LIVESTREAMING"===this.livestreamState)try{await(null===(t=this.meeting.livestream)||void 0===t?void 0:t.stop())}catch(t){this.dyteAPIError.emit({trace:this.t("livestream.stop"),message:this.t("livestream.error.stop")})}else try{await(null===(s=this.meeting.livestream)||void 0===s?void 0:s.start())}catch(t){this.dyteAPIError.emit({trace:this.t("livestream.start"),message:this.t("livestream.error.start")})}}clearListeners(){var t;null===(t=this.meeting.livestream)||void 0===t||t.removeListener("livestreamUpdate",this.livestreamStateListener)}getLivestreamLabel(){switch(this.livestreamState){case"IDLE":return this.t("livestream.go_live");case"LIVESTREAMING":return this.t("livestream.end_live");case"WAITING_ON_MANUAL_INGESTION":return this.t("livestream.waiting_on_manual_ingestion");case"STARTING":return this.t("livestream.starting");case"STOPPING":return this.t("livestream.stopping");default:return this.t("livestream.error")}}getLivestreamIcon(){switch(this.livestreamState){case"IDLE":return this.iconPack.start_livestream;case"LIVESTREAMING":return this.iconPack.stop_livestream;case"WAITING_ON_MANUAL_INGESTION":return this.iconPack.start_livestream;case"STARTING":case"STOPPING":default:return this.iconPack.stop_livestream}}render(){if(h(this.meeting))return i(e,null,i("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,t:this.t,isLoading:this.isLoading(),class:{"active-livestream":"LIVESTREAMING"===this.livestreamState},onClick:()=>this.toggleLivestream(),icon:this.getLivestreamIcon(),disabled:this.isLoading(),label:this.t(this.getLivestreamLabel()),variant:this.variant}))}static get watchers(){return{meeting:["meetingChanged"]}}};o.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";export{o as dyte_livestream_toggle}