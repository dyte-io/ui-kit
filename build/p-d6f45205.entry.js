import{r as t,h as i}from"./p-aff91b47.js";import{d as e,u as s}from"./p-9362c375.js";import{d as a}from"./p-5a97005d.js";import"./p-e497ad6d.js";import{S as r}from"./p-2fbb888d.js";var n=function(t,i,e,s){var a,r=arguments.length,n=r<3?i:null===s?s=Object.getOwnPropertyDescriptor(i,e):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,i,e,s);else for(var p=t.length-1;p>=0;p--)(a=t[p])&&(n=(r<3?a(n):r>3?a(i,e,n):a(i,e))||n);return r>3&&n&&Object.defineProperty(i,e,n),n};const p=class{constructor(r){t(this,r),this.updateStageViewers=()=>{this.getViewers(this.search)},this.config=a,this.hideHeader=!1,this.iconPack=e,this.view="sidebar",this.search="",this.t=s(),this.stageViewers=[],this.createParticipantNode=t=>i("dyte-participant",{role:"listitem",key:t.id,meeting:this.meeting,participant:t,view:this.view,iconPack:this.iconPack,config:this.config,t:this.t}),this.shouldShowViewers=()=>{var t,i,e;return null===(e=null===(i=null===(t=this.meeting)||void 0===t?void 0:t.self)||void 0===i?void 0:i.permissions)||void 0===e?void 0:e.stageEnabled}}connectedCallback(){this.meetingChanged(this.meeting),this.searchChanged(this.search)}meetingChanged(t){null!=t&&(this.participantJoinedListener=t=>{if("ON_STAGE"===t.stageStatus)return;const i=this.search.toLowerCase();i.length>0&&!t.name.toLowerCase().includes(i)||(this.stageViewers=[...this.stageViewers.filter((i=>i.id!==t.id)),t])},this.participantLeftListener=t=>{this.stageViewers=this.stageViewers.filter((i=>i.id!==t.id))},t.participants.joined.addListener("participantJoined",this.participantJoinedListener),t.participants.joined.addListener("participantLeft",this.participantLeftListener),t.participants.joined.on("stageStatusUpdate",this.updateStageViewers),t.stage.on("stageStatusUpdate",this.updateStageViewers))}searchChanged(t){this.getViewers(t)}disconnectedCallback(){const{participants:t,stage:i}=this.meeting;this.participantJoinedListener&&this.meeting.participants.joined.removeListener("participantJoined",this.participantJoinedListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),t.joined.removeListener("stageStatusUpdate",this.updateStageViewers),i.removeListener("stageStatusUpdate",this.updateStageViewers)}getViewers(t){let i="ON_STAGE"===this.meeting.stage.status?[]:[this.meeting.self];i=[...i,...this.meeting.participants.joined.toArray()].filter((t=>"ON_STAGE"!==t.stageStatus)),this.stageViewers=""===t?i:i.filter((i=>{var e;return(null!==(e=i.name)&&void 0!==e?e:i.id).toLowerCase().includes(t.toLowerCase())}))}render(){if("sidebar"===this.view&&this.shouldShowViewers())return i("div",{class:"list"},!this.hideHeader&&i("div",{class:"heading-count",part:"heading-count"},this.t("viewers")," (",this.stageViewers.length,")"),i("dyte-virtualized-participant-list",{items:this.stageViewers,renderItem:this.createParticipantNode,class:"participants",part:"participants",style:{height:"100%"},emptyListElement:i("div",{class:"empty-viewers-list"},this.t(this.search.length>0?"participants.errors.empty_results":"participants.empty_list"))}))}static get watchers(){return{meeting:["meetingChanged"],search:["searchChanged"]}}};n([r()],p.prototype,"meeting",void 0),n([r()],p.prototype,"iconPack",void 0),n([r()],p.prototype,"t",void 0),p.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;width:100%;flex-direction:column;font-size:14px}.list{margin-bottom:var(--dyte-space-4, 16px);display:flex;height:100%;flex-direction:column}h3,.heading-count{margin:var(--dyte-space-0, 0px);align-items:center;justify-content:center;padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:400;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));text-align:center}.heading-count{font-size:14px}.participants{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.empty-viewers-list{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);text-align:center;font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}";export{p as dyte_participants_viewer_list}