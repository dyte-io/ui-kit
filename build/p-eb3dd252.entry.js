import{r as t,c as i,h as e,H as s,a}from"./p-aff91b47.js";import{d,u as h,F as n,s as c}from"./p-9362c375.js";import{l as o,R as l}from"./p-fd4b6d8b.js";import{f as r,s as f}from"./p-338c7261.js";import{d as p}from"./p-5a97005d.js";import"./p-e497ad6d.js";import{c as b,a as y,o as v,s as m,h as u}from"./p-4ebfbb95.js";import{S as g}from"./p-2fbb888d.js";var k=function(t,i,e,s){var a,d=arguments.length,h=d<3?i:null===s?s=Object.getOwnPropertyDescriptor(i,e):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,i,e,s);else for(var n=t.length-1;n>=0;n--)(a=t[n])&&(h=(d<3?a(h):d>3?a(i,e,h):a(i,e))||h);return d>3&&h&&Object.defineProperty(i,e,h),h};const x=class{constructor(e){t(this,e),this.dyteSendNotification=i(this,"dyteSendNotification",7),this.pinnedListener=({isPinned:t})=>{this.isPinned=t},this.toggleTileListener=({hidden:t})=>{this.isHidden=t},this.stageListener=({stageStatus:t})=>{this.isOnStage="ON_STAGE"===t},this.view="sidebar",this.iconPack=d,this.t=h(),this.config=p,this.audioEnabled=!1,this.videoEnabled=!1,this.isPinned=!1,this.isHidden=!1,this.isOnStage=!1,this.canDisableParticipantAudio=!1,this.canDisableParticipantVideo=!1,this.canKickParticipant=!1,this.canPinParticipant=!1,this.canAllowParticipantOnStage=!1,this.menuOpen=!1,this.permissionsUpdateListener=()=>{this.meetingChanged(this.meeting)},this.inviteToStageToggle=async()=>{const t=this.participant,{stage:i}=this.meeting;"ACCEPTED_TO_JOIN_STAGE"!==t.stageStatus?(this.isOnStage?(t.isPinned&&t.unpin(),await i.kick([t.userId])):(await i.grantAccess([t.userId]),this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-invite-${t.id}`})),this.isOnStage="ON_STAGE"===t.stageStatus):this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-${t.id}`})},this.handleOutsideClick=t=>{!t.composedPath().includes(this.host)&&this.menuOpen&&(this.menuOpen=!1)},this.update=()=>{const t=this.host.shadowRoot.getElementById("trigger"),i=this.host.shadowRoot.getElementById("menu-list");b(t,i,{placement:"bottom-end",middleware:[y({allowedPlacements:["bottom-end","top-end"],alignment:"end"}),v(4),m({padding:8}),u()]}).then((({x:t,y:e,placement:s})=>{let a=null;a="bottom-end"===s?{right:`${t}px`,top:`${e}px`}:{right:`${t}px`,bottom:`${e}px`},Object.assign(i.style,a)}))},this.onMenuToggle=()=>{this.menuOpen=!this.menuOpen,this.menuOpen&&this.update()}}connectedCallback(){this.meetingChanged(this.meeting),this.participantChanged(this.participant),document.addEventListener("click",this.handleOutsideClick)}disconnectedCallback(){var t;document.removeEventListener("click",this.handleOutsideClick),null===(t=this.meeting)||void 0===t||t.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener),null!=this.participant&&null!=this.participant.removeListener&&(this.audioUpdateListener&&this.participant.removeListener("audioUpdate",this.audioUpdateListener),this.videoUpdateListener&&this.participant.removeListener("videoUpdate",this.videoUpdateListener),this.participant.removeListener("pinned",this.pinnedListener),this.participant.removeListener("unpinned",this.pinnedListener),this.participant.removeListener("stageStatusUpdate",this.stageListener),this.participant.removeListener("toggleTile",this.toggleTileListener))}meetingChanged(t){var i,e,s,a,d,h,c;if(null!=t){const{self:o}=t;this.canDisableParticipantAudio=o.permissions.canAllowParticipantAudio||o.permissions.canDisableParticipantAudio,this.canDisableParticipantVideo=o.permissions.canAllowParticipantVideo||o.permissions.canDisableParticipantVideo,this.canKickParticipant=o.permissions.kickParticipant&&!0!==(null===(i=this.meeting)||void 0===i?void 0:i.__internals__.features.hasFeature(n.DISABLE_KICKING))&&(!0!==(null===(e=this.meeting)||void 0===e?void 0:e.__internals__.features.hasFeature(n.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(s=this.participant)||void 0===s?void 0:s.presetName)),this.canPinParticipant=o.permissions.pinParticipant,this.canAllowParticipantOnStage=o.permissions.acceptStageRequests&&o.permissions.stageEnabled&&(!0!==(null===(a=this.meeting)||void 0===a?void 0:a.__internals__.features.hasFeature(n.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(d=this.participant)||void 0===d?void 0:d.presetName))&&(!0!==(null===(h=this.meeting)||void 0===h?void 0:h.__internals__.features.hasFeature(n.CANTINVITE_VIEWER))||"webinar_viewer"!==(null===(c=this.participant)||void 0===c?void 0:c.presetName)),t.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)}}participantChanged(t){var i;if(null!=t){if(this.audioEnabled=t.audioEnabled,this.videoEnabled=t.videoEnabled,this.isPinned=t.isPinned,this.isHidden=null!==(i=t.hidden)&&void 0!==i&&i,this.isOnStage="ON_STAGE"===t.stageStatus,this.audioUpdateListener=({audioEnabled:t})=>{this.audioEnabled=t},this.videoUpdateListener=({videoEnabled:t})=>{this.videoEnabled=t},null==t.addListener)return;t.addListener("audioUpdate",this.audioUpdateListener),t.addListener("videoUpdate",this.videoUpdateListener),t.addListener("pinned",this.pinnedListener),t.addListener("unpinned",this.pinnedListener),t.addListener("stageStatusUpdate",this.stageListener),this.participant.addListener("toggleTile",this.toggleTileListener)}}render(){var t,i,a,d,h,n,p,b,y;const v="AUDIO_ROOM"===(null===(t=this.meeting)||void 0===t?void 0:t.meta.viewType),m=(null===(i=this.meeting)||void 0===i?void 0:i.self.id)===this.participant.id,u=this.canDisableParticipantAudio&&this.audioEnabled||this.canDisableParticipantVideo&&this.videoEnabled&&!v||this.canKickParticipant||this.canPinParticipant&&this.isOnStage||this.canAllowParticipantOnStage,g=r((null===(a=this.participant)||void 0===a?void 0:a.name)||""),k=this.isOnStage||["GROUP_CALL","AUDIO_ROOM"].includes(null===(d=this.meeting)||void 0===d?void 0:d.meta.viewType),x={meeting:this.meeting,size:"sm",states:c,config:this.config,iconPack:this.iconPack,t:this.t};return e(s,{key:"1fa766d2be97ec19e57b8f92bf44103f0ecc5c71"},e("div",{class:"left",key:null===(h=this.participant)||void 0===h?void 0:h.id},e("dyte-avatar",{key:"5becacba019dbe9f988e742e30cb477cf07c6816",participant:this.participant,size:"sm",iconPack:this.iconPack,t:this.t}),e("p",{key:"f96102e70cc238920f30328c900a130d5f0e5652",class:"name",title:g},f(g,16)," ",(null===(n=this.meeting)||void 0===n?void 0:n.self.id)===(null===(p=this.participant)||void 0===p?void 0:p.id)&&this.t("(you)"))),"sidebar"===this.view&&e("div",{key:"df59f385d405bfb0e53e6d68a4679885c4a80a0a",class:"right"},k&&e("dyte-icon",{key:"e6f050076e7f9c99906a5796f048f44777302532",class:{red:!this.audioEnabled},icon:this.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off}),k&&!v&&e("dyte-icon",{key:"77672abacfdfbcb27bab4c21a1c99443447ea504",class:{red:!this.videoEnabled},icon:this.videoEnabled?this.iconPack.video_on:this.iconPack.video_off}),(u||o({element:"dyte-participant",defaults:x,childProps:{participant:this.participant}})>0)&&e("div",{key:"ac95dc80ca3c743aea19b400d0806162e68431c3",class:"menu"},e("span",{key:"114389b1624688e636ed72d803945499bebe6b78",id:"trigger",onClick:this.onMenuToggle},e("dyte-button",{key:"da9eb721eb78ccc8db69685a7b5d0dc36f7111a6",variant:"ghost",kind:"icon",slot:"trigger"},e("dyte-icon",{key:"4db4d00c85701fdc5ea7c0279793c042112ad573",class:"more",icon:this.iconPack.more_vertical}))),e("span",{key:"eaf7a89c1c3d798ad8eb09928e725abfbbb5f095",id:"menu-list"},this.menuOpen&&e("dyte-menu-list",{key:"4d5b04dbb8d8fe06b584b10a93d163db17c80630",iconPack:this.iconPack,t:this.t},this.canPinParticipant&&k&&!v&&e("dyte-menu-item",{key:"139153857bb722f14a1efc15978e2695cbd9d023",onClick:()=>{this.isPinned?this.participant.unpin():this.participant.pin()},iconPack:this.iconPack,t:this.t},e("dyte-icon",{key:"a33cdf04a5451264f30001d9cc1eb13e3090a755",icon:this.isPinned?this.iconPack.pin_off:this.iconPack.pin,slot:"start"}),this.t(this.isPinned?"unpin":"pin")),m&&e("dyte-menu-item",{key:"b305bc252002513424cb95ec9e8b9e266afe256f",iconPack:this.iconPack,t:this.t,onClick:()=>{this.isHidden?this.participant.show():this.participant.hide()}},e("dyte-icon",{key:"779f379dfcaa37c8217786848b7920b42c27b6f0",icon:this.isHidden?this.iconPack.minimize:this.iconPack.maximize,slot:"start"}),this.t(this.meeting.self.hidden?"maximize":"minimize")),this.canDisableParticipantAudio&&k&&this.audioEnabled&&e("dyte-menu-item",{key:"b06f61b166a1eb6ab648b6f0d9e7c5f41fb5fac6",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableAudio()}},e("dyte-icon",{key:"13b2d42b5863dd5a9e809fdd9cc4b618cefd366d",icon:this.iconPack.mic_off,slot:"start"}),this.t("mute")),this.canDisableParticipantVideo&&k&&this.videoEnabled&&e("dyte-menu-item",{key:"dc10d4131e4efd95b68c19462f002aea6526cc8e",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableVideo()}},e("dyte-icon",{key:"d0916bb83010a4e0b21f65a2a4ce018423311bde",icon:this.iconPack.video_off,slot:"start"}),this.t("participants.turn_off_video")),this.canAllowParticipantOnStage&&(null===(b=this.participant)||void 0===b?void 0:b.id)!==(null===(y=this.meeting)||void 0===y?void 0:y.self.id)&&e("dyte-menu-item",{key:"f9b976bf7d7d5402b9c59075915c281ef9b28f98",iconPack:this.iconPack,t:this.t,class:this.isOnStage?"red":"",onClick:this.inviteToStageToggle},e("dyte-icon",{key:"27833af40104dffccf1a3673981e55d26cb774ff",icon:this.isOnStage?this.iconPack.leave_stage:this.iconPack.join_stage,slot:"start"}),this.t(this.isOnStage?"stage.remove_from_stage":"stage.add_to_stage")),!m&&this.canKickParticipant&&e("dyte-menu-item",{key:"f1dc896d27a7cf123a1ec11da647f4de886cb493",iconPack:this.iconPack,t:this.t,class:"red",onClick:()=>{var t,i;null===(t=this.meeting)||void 0===t||t.participants.kick(null===(i=this.participant)||void 0===i?void 0:i.id)}},e("dyte-icon",{key:"94751b8551d7ced0a545043c920ca0e30d8a1104",icon:this.iconPack.dismiss,slot:"start"}),this.t("kick")),e("slot",{key:"adc0cfe90454b8377579b26f049f545f065b5368"},e(l,{key:"51b1e6da1422639a749e6a8afa6ce5ecae46cb9c",element:"dyte-participant",defaults:x,childProps:{participant:this.participant},deepProps:!0,onlyChildren:!0})))))))}get host(){return a(this)}static get watchers(){return{meeting:["meetingChanged"],participant:["participantChanged"]}}};k([g()],x.prototype,"meeting",void 0),k([g()],x.prototype,"iconPack",void 0),k([g()],x.prototype,"t",void 0),x.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;height:var(--dyte-space-14, 56px);align-items:center;justify-content:space-between;cursor:pointer;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}:host dyte-avatar{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);font-size:14px}.left{display:flex;align-items:center}.left>*{margin-right:var(--dyte-space-2, 8px)}.left>*:last-child{margin-right:var(--dyte-space-0, 0px)}.right{display:flex;align-items:center;justify-content:flex-end}.right>*{margin-left:var(--dyte-space-2, 8px)}.right>*:first-child{margin-left:var(--dyte-space-0, 0px)}.name{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}dyte-icon.red{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon.more{cursor:pointer}.menu{position:relative;display:inline-block;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}#menu-list{position:absolute;top:var(--dyte-space-8, 32px) !important;right:var(--dyte-space-4, 16px) !important;z-index:20}";export{x as dyte_participant}