import{r as t,c as i,h as s,H as e,a as h}from"./p-69f2ebde.js";import{d as a}from"./p-cadf534b.js";import{u as n}from"./p-f9791180.js";import{l as o,R as d}from"./p-4dfeaf93.js";import{f as l,s as r}from"./p-4de316e3.js";import{s as c}from"./p-1210aa77.js";import"./p-26e8d50e.js";import{d as p}from"./p-ba748e25.js";import"./p-799d72ea.js";import{F as m}from"./p-19c79157.js";import"./p-57e22a58.js";import{c as v,a as u,o as g,s as y,h as f}from"./p-5bd2f07d.js";import"./p-aafa2ac8.js";const k=class{constructor(s){t(this,s),this.dyteSendNotification=i(this,"dyteSendNotification",7),this.pinnedListener=({isPinned:t})=>{this.isPinned=t},this.stageListener=({stageStatus:t})=>{this.isOnStage="ON_STAGE"===t},this.permissionsUpdateListener=()=>{this.meetingChanged(this.meeting)},this.inviteToStageToggle=async()=>{const t=this.participant,{stage:i}=this.meeting;"ACCEPTED_TO_JOIN_STAGE"!==t.stageStatus?(this.isOnStage?(t.isPinned&&t.unpin(),await i.kick([t.userId])):(await i.grantAccess([t.userId]),this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-invite-${t.id}`})),this.isOnStage="ON_STAGE"===t.stageStatus):this.dyteSendNotification.emit({message:`${t.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-${t.id}`})},this.handleOutsideClick=t=>{!t.composedPath().includes(this.host)&&this.menuOpen&&(this.menuOpen=!1)},this.update=()=>{const t=this.host.shadowRoot.getElementById("trigger"),i=this.host.shadowRoot.getElementById("menu-list");v(t,i,{placement:"bottom-end",middleware:[u({allowedPlacements:["bottom-end","top-end"],alignment:"end"}),g(4),y({padding:8}),f()]}).then((({x:t,y:s,placement:e})=>{let h=null;h="bottom-end"===e?{right:`${t}px`,top:`${s}px`}:{right:`${t}px`,bottom:`${s}px`},Object.assign(i.style,h)}))},this.onMenuToggle=()=>{this.menuOpen=!this.menuOpen,this.menuOpen&&this.update()},this.meeting=void 0,this.view="sidebar",this.participant=void 0,this.iconPack=a,this.t=n(),this.config=p,this.audioEnabled=!1,this.videoEnabled=!1,this.isPinned=!1,this.isOnStage=!1,this.canDisableParticipantAudio=!1,this.canDisableParticipantVideo=!1,this.canKickParticipant=!1,this.canPinParticipant=!1,this.canAllowParticipantOnStage=!1,this.menuOpen=!1}connectedCallback(){this.meetingChanged(this.meeting),this.participantChanged(this.participant),document.addEventListener("click",this.handleOutsideClick)}disconnectedCallback(){var t;document.removeEventListener("click",this.handleOutsideClick),null===(t=this.meeting)||void 0===t||t.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener),null!=this.participant&&null!=this.participant.removeListener&&(this.audioUpdateListener&&this.participant.removeListener("audioUpdate",this.audioUpdateListener),this.videoUpdateListener&&this.participant.removeListener("videoUpdate",this.videoUpdateListener),this.participant.removeListener("pinned",this.pinnedListener),this.participant.removeListener("unpinned",this.pinnedListener),this.participant.removeListener("stageStatusUpdate",this.stageListener))}meetingChanged(t){var i,s,e,h,a,n,o;if(null!=t){const{self:d}=t;this.canDisableParticipantAudio=d.permissions.canAllowParticipantAudio||d.permissions.canDisableParticipantAudio,this.canDisableParticipantVideo=d.permissions.canAllowParticipantVideo||d.permissions.canDisableParticipantVideo,this.canKickParticipant=d.permissions.kickParticipant&&!0!==(null===(i=this.meeting)||void 0===i?void 0:i.__internals__.features.hasFeature(m.DISABLE_KICKING))&&(!0!==(null===(s=this.meeting)||void 0===s?void 0:s.__internals__.features.hasFeature(m.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(e=this.participant)||void 0===e?void 0:e.presetName)),this.canPinParticipant=d.permissions.pinParticipant,this.canAllowParticipantOnStage=d.permissions.acceptStageRequests&&d.permissions.stageEnabled&&(!0!==(null===(h=this.meeting)||void 0===h?void 0:h.__internals__.features.hasFeature(m.ADMIN_CANTREMOVE_ADMIN))||"webinar_admin"!==(null===(a=this.participant)||void 0===a?void 0:a.presetName))&&(!0!==(null===(n=this.meeting)||void 0===n?void 0:n.__internals__.features.hasFeature(m.CANTINVITE_VIEWER))||"webinar_viewer"!==(null===(o=this.participant)||void 0===o?void 0:o.presetName)),t.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)}}participantChanged(t){if(null!=t){if(this.audioEnabled=t.audioEnabled,this.videoEnabled=t.videoEnabled,this.isPinned=t.isPinned,this.isOnStage="ON_STAGE"===t.stageStatus,this.audioUpdateListener=({audioEnabled:t})=>{this.audioEnabled=t},this.videoUpdateListener=({videoEnabled:t})=>{this.videoEnabled=t},null==t.addListener)return;t.addListener("audioUpdate",this.audioUpdateListener),t.addListener("videoUpdate",this.videoUpdateListener),t.addListener("pinned",this.pinnedListener),t.addListener("unpinned",this.pinnedListener),t.addListener("stageStatusUpdate",this.stageListener)}}render(){var t,i,h,a,n,p,m,v,u;const g="AUDIO_ROOM"===(null===(t=this.meeting)||void 0===t?void 0:t.meta.viewType),y=(null===(i=this.meeting)||void 0===i?void 0:i.self.id)===this.participant.id,f=this.canDisableParticipantAudio&&this.audioEnabled||this.canDisableParticipantVideo&&this.videoEnabled&&!g||this.canKickParticipant||this.canPinParticipant&&this.isOnStage||this.canAllowParticipantOnStage,k=l((null===(h=this.participant)||void 0===h?void 0:h.name)||""),b=this.isOnStage||["GROUP_CALL","AUDIO_ROOM"].includes(null===(a=this.meeting)||void 0===a?void 0:a.meta.viewType),x={meeting:this.meeting,size:"sm",states:c,config:this.config,iconPack:this.iconPack,t:this.t};return s(e,null,s("div",{class:"left",key:null===(n=this.participant)||void 0===n?void 0:n.id},s("dyte-avatar",{participant:this.participant,size:"sm",iconPack:this.iconPack,t:this.t}),s("p",{class:"name",title:k},r(k,16)," ",(null===(p=this.meeting)||void 0===p?void 0:p.self.id)===(null===(m=this.participant)||void 0===m?void 0:m.id)&&this.t("(you)"))),"sidebar"===this.view&&s("div",{class:"right"},b&&s("dyte-icon",{class:{red:!this.audioEnabled},iconPack:this.iconPack,t:this.t,icon:this.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off}),b&&!g&&s("dyte-icon",{class:{red:!this.videoEnabled},iconPack:this.iconPack,t:this.t,icon:this.videoEnabled?this.iconPack.video_on:this.iconPack.video_off}),(f||o({element:"dyte-participant",defaults:x,childProps:{participant:this.participant}})>0)&&s("div",{class:"menu"},s("span",{id:"trigger",onClick:this.onMenuToggle},s("dyte-button",{variant:"ghost",kind:"icon",slot:"trigger",iconPack:this.iconPack,t:this.t},s("dyte-icon",{class:"more",icon:this.iconPack.more_vertical}))),s("span",{id:"menu-list"},this.menuOpen&&s("dyte-menu-list",{iconPack:this.iconPack,t:this.t},this.canPinParticipant&&b&&!g&&s("dyte-menu-item",{onClick:()=>{this.isPinned?this.participant.unpin():this.participant.pin()},iconPack:this.iconPack,t:this.t},s("dyte-icon",{icon:this.isPinned?this.iconPack.pin_off:this.iconPack.pin,slot:"start",iconPack:this.iconPack,t:this.t}),this.t(this.isPinned?"unpin":"pin")),this.canDisableParticipantAudio&&b&&this.audioEnabled&&s("dyte-menu-item",{iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableAudio()}},s("dyte-icon",{icon:this.iconPack.mic_off,slot:"start"}),this.t("mute")),this.canDisableParticipantVideo&&b&&this.videoEnabled&&s("dyte-menu-item",{iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableVideo()}},s("dyte-icon",{icon:this.iconPack.video_off,slot:"start",iconPack:this.iconPack,t:this.t}),this.t("participants.turn_off_video")),this.canAllowParticipantOnStage&&(null===(v=this.participant)||void 0===v?void 0:v.id)!==(null===(u=this.meeting)||void 0===u?void 0:u.self.id)&&s("dyte-menu-item",{iconPack:this.iconPack,t:this.t,class:this.isOnStage?"red":"",onClick:this.inviteToStageToggle},s("dyte-icon",{iconPack:this.iconPack,t:this.t,icon:this.isOnStage?this.iconPack.leave_stage:this.iconPack.join_stage,slot:"start"}),this.t(this.isOnStage?"stage.remove_from_stage":"stage.add_to_stage")),!y&&this.canKickParticipant&&s("dyte-menu-item",{iconPack:this.iconPack,t:this.t,class:"red",onClick:()=>{var t,i;null===(t=this.meeting)||void 0===t||t.participants.kick(null===(i=this.participant)||void 0===i?void 0:i.id)}},s("dyte-icon",{icon:this.iconPack.dismiss,slot:"start",iconPack:this.iconPack,t:this.t}),this.t("kick")),s("slot",null,s(d,{element:"dyte-participant",defaults:x,childProps:{participant:this.participant},deepProps:!0,onlyChildren:!0})))))))}get host(){return h(this)}static get watchers(){return{meeting:["meetingChanged"],participant:["participantChanged"]}}};k.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;height:var(--dyte-space-14, 56px);align-items:center;justify-content:space-between;cursor:pointer;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}:host dyte-avatar{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);font-size:14px}.left{display:flex;align-items:center}.left>*{margin-right:var(--dyte-space-2, 8px)}.left>*:last-child{margin-right:var(--dyte-space-0, 0px)}.right{display:flex;align-items:center;justify-content:flex-end}.right>*{margin-left:var(--dyte-space-2, 8px)}.right>*:first-child{margin-left:var(--dyte-space-0, 0px)}.name{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}dyte-icon.red{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon.more{cursor:pointer}.menu{position:relative;display:inline-block;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}#menu-list{position:absolute;z-index:20}";export{k as dyte_participant}